(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[251],{3649:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var s=l(5155),n=l(5726),r=l(2302),a=l(8534);function i(e){let{snackbarSettings:t,setSnackbarSettings:l}=e,{open:i,message:o,severity:c,actionLabel:d,actionCallback:u,duration:m}=t,h=()=>{l(e=>({...e,open:!1,actionLable:null,actionCallback:null}))};return(0,s.jsx)(n.A,{open:i,autoHideDuration:void 0!==m?m:2e3,anchorOrigin:{vertical:"top",horizontal:"center"},onClose:h,children:(0,s.jsx)(r.A,{severity:c,variant:"standard",className:"w-full",onClose:h,action:d&&u?(0,s.jsx)(a.A,{color:"error",size:"small",onClick:()=>{u&&(u(),l(e=>({...e,open:!1})))},children:d}):null,children:o})})}},5318:(e,t,l)=>{"use strict";l.d(t,{default:()=>h});var s=l(5155),n=l(2115),r=l(5381),a=l(313);function i(e){let{open:t,onClose:l,onCreate:r}=e,[i,o]=(0,n.useState)(""),[c,d]=(0,n.useState)(null),[u,m]=(0,n.useState)(!1),[h,f]=(0,n.useState)(null),p=(0,n.useRef)(null);(0,n.useEffect)(()=>{t||(o(""),d(null),m(!1),f(null))},[t]);let v=(0,n.useMemo)(()=>c?URL.createObjectURL(c):null,[c]);async function x(){try{if(f(null),!i.trim())return void f("Please enter a season name.");m(!0),await r({name:i.trim(),file:c}),l()}catch(e){f(e instanceof Error?null==e?void 0:e.message:"Failed to create season.")}finally{m(!1)}}return(0,n.useEffect)(()=>()=>{v&&URL.revokeObjectURL(v)},[v]),(0,s.jsxs)(a.lG,{open:t,onClose:u?()=>{}:l,className:"relative z-[2000]",children:[(0,s.jsx)(a.Xi,{className:"fixed inset-0 bg-black/60 backdrop-blur-sm"}),(0,s.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,s.jsx)("div",{className:"flex min-h-full items-center justify-center p-4",children:(0,s.jsxs)(a.Lj,{className:"w-full max-w-md rounded-2xl bg-[#212e3f] p-5 text-white shadow-xl ring-1 ring-white/10",children:[(0,s.jsx)(a.L3,{className:"text-lg font-semibold",children:"Add Season"}),(0,s.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,s.jsxs)("label",{className:"block",children:[(0,s.jsx)("div",{className:"mb-1 text-sm text-white/80",children:"Season name"}),(0,s.jsx)("input",{type:"text",value:i,onChange:e=>o(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30",placeholder:"e.g., Summer 2025",disabled:u})]}),(0,s.jsxs)("div",{className:"rounded-xl border border-dashed border-white/15 bg-[#131a2a] p-3",onDragOver:e=>e.preventDefault(),onDrop:function(e){var t;e.preventDefault();let l=null==(t=e.dataTransfer.files)?void 0:t[0];l&&l.type.startsWith("image/")&&(f(null),d(l))},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm text-white/80",children:"Season image"}),(0,s.jsx)("div",{className:"text-xs text-white/50",children:"Drag & drop or pick a file (PNG/JPG)"})]}),(0,s.jsx)("button",{type:"button",onClick:function(){var e;null==(e=p.current)||e.click()},disabled:u,className:"rounded-md bg-white/10 px-3 py-1.5 text-sm hover:bg-white/20 disabled:opacity-50",children:"Browse…"})]}),(0,s.jsx)("input",{ref:p,type:"file",accept:"image/*",onChange:function(e){var t;let l=null==(t=e.target.files)?void 0:t[0];if(l){if(!l.type.startsWith("image/"))return void f("Please select an image file.");f(null),d(l)}},className:"hidden"}),v?(0,s.jsx)("div",{className:"mt-3 relative aspect-video w-full overflow-hidden rounded-lg",children:(0,s.jsx)("img",{src:v,alt:"Preview",className:"h-full w-full object-contain bg-black/20"})}):(0,s.jsx)("div",{className:"mt-3 flex h-28 items-center justify-center rounded-lg bg-black/20 text-xs text-white/50",children:"No image selected"})]}),h&&(0,s.jsx)("div",{className:"text-xs text-red-300",children:h}),(0,s.jsxs)("div",{className:"mt-2 flex justify-end gap-2",children:[(0,s.jsx)("button",{type:"button",onClick:l,disabled:u,className:"rounded-lg px-3 py-2 text-sm bg-white/10 hover:bg-white/20 disabled:opacity-50",children:"Cancel"}),(0,s.jsx)("button",{type:"button",onClick:x,disabled:u||!i.trim(),className:"rounded-lg px-3 py-2 text-sm font-medium text-black bg-green-400 hover:bg-green-500 disabled:opacity-50",children:u?"Saving…":"Create"})]})]})]})})})]})}var o=l(7217),c=l(3649),d=l(7153),u=l(3127),m=l(7857);function h(){let e=(0,n.useRef)(null),[t,l]=(0,n.useState)(""),{user:a,profile:h}=(0,r.J)(),[f,p]=(0,n.useState)(!1),[v,x]=(0,n.useState)(""),[g,b]=(0,n.useState)(!1),[w,N]=(0,n.useState)([]),[j,y]=(0,n.useState)(!1),[C,I]=(0,n.useState)({open:!1,message:"",severity:""});async function k(e){let{name:t,file:l}=e,s=new FormData;s.append("name",t),l&&s.append("file",l);let n=await fetch("/api/admin/seasons/create",{method:"POST",body:s});if(n.ok)I(e=>({...e,open:!0,message:"Added Season Successfully",severity:"success"}));else throw I(e=>({...e,open:!0,message:"Season Creation Failed",severity:"error"})),Error((await n.json()).error||"Create failed")}async function S(e){let t;y(!0),t=e?await fetch("/api/admin/seasons/set_season/".concat(e),{method:"PATCH",headers:{Accept:"application/json"}}):await fetch("/api/admin/seasons/set_season/none",{method:"PATCH"});let l=await t.json();if(console.log({data:l}),t.ok)I(e=>({...e,open:!0,message:"Saved Season Successfully",severity:"success"}));else throw I(e=>({...e,open:!0,message:"Failed to set active season",severity:"error"})),Error((null==l?void 0:l.error)||"Failed to set active season");return y(!1),l.item}async function D(e){e||I({open:!0,message:"ID missing",severity:"error"}),I({open:!0,message:"Are you sure you want to delete this season?",severity:"warning",actionLabel:"Delete",duration:1e4,actionCallback:async()=>{try{let t=await fetch("/api/admin/seasons/set_season/".concat(e),{method:"DELETE"}),l=await t.json();if(t.ok)I({open:!0,message:"Season Deleted Successfully",severity:"success"});else throw I({open:!0,message:"Delete Season failed",severity:"error"}),Error((null==l?void 0:l.error)||"Delete failed")}catch(e){I({open:!0,message:e instanceof Error?e.message:"Delete failed",severity:"error"})}}})}return(0,n.useEffect)(()=>{(0,o.Nb)({setSeasons:N,setLoading:b})},[]),(0,n.useEffect)(()=>{if(!w)return;let e=w.find(e=>!0===e.is_active);console.log({currentActive:e}),l((null==e?void 0:e.image_url)||""),x((null==e?void 0:e.id)||"")},[w]),console.log({seasons:w}),console.log("user",a),console.log("profile",h),console.log("role",null==h?void 0:h.role),console.log(t),console.log({selectedSeasonId:v}),(0,s.jsxs)("div",{className:"font-sans flex flex-col gap-4 md:flex-row min-h-screen md:h-screen p-8 md:gap-8 sm:px-20 bg-[#151c2f]",children:[(0,s.jsxs)("div",{className:"md:w-[25%] text-white h-[90%] md:overflow-scroll custom-scrollbar shadow-xl rounded-xl bg-[#212e3f] p-3 md:p-5 space-y-4",children:[(null==h?void 0:h.role)==="super-admin"&&(0,s.jsxs)("div",{className:"sticky w-full top-0 bg-[#212e3f] z-20 rounded-lg flex justify-between",children:[(0,s.jsxs)("div",{className:"flex gap-x-2",children:[(0,s.jsx)("button",{onClick:()=>p(!0),className:"px-3 py-2 rounded-lg bg-blue-400 hover:bg-blue-500 hover:cursor-pointer text-black font-medium disabled:cursor-not-allowed",children:"Add"}),(0,s.jsx)("button",{onClick:()=>D(v),className:"px-3 py-2 rounded-lg bg-red-600 hover:bg-red-700 hover:cursor-pointer font-medium disabled:cursor-not-allowed",children:"Delete"})]}),(0,s.jsx)(u.A,{size:"small",onClick:()=>{(0,o.Nb)({setSeasons:N,setLoading:b})},children:(0,s.jsx)(m.A,{htmlColor:"#9ca3af",fontSize:"medium"})})]}),w.map(e=>(0,s.jsxs)("div",{onClick:()=>{l((null==e?void 0:e.image_url)||""),x(e.id)},className:"flex-col border relative border-white/10 rounded-lg overflow-hidden  hover:scale-[1.05] transition-transform duration-300 cursor-pointer ".concat(e.id===v?" shadow-2xl scale-[1.05]":""),children:[(0,s.jsx)("div",{className:" relative aspect-video w-full overflow-hidden rounded-lg",children:(0,s.jsx)("img",{src:e.image_url||"",alt:e.name,className:"h-full w-full object-contain bg-black/20"})}),(0,s.jsx)("div",{className:"p-2  bg-[#1a2536]",children:(0,s.jsx)("h3",{className:"text-md font-semibold",children:e.name})})]},e.id)),(0,s.jsxs)("div",{className:"flex mt-4 gap-2",children:[(0,s.jsx)("button",{onClick:()=>{S(v)},disabled:j,className:"px-3 py-2 rounded-lg bg-green-400 hover:bg-green-500 hover:cursor-pointer text-black font-medium disabled:cursor-not-allowed",children:j?(0,s.jsxs)("span",{className:"inline-flex items-center gap-2",children:["Saving",(0,s.jsxs)("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4A4 4 0 004 12z"})]})]}):"Save"}),(0,s.jsx)("button",{className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white hover:cursor-pointer",onClick:()=>{l(""),x("")},children:"Clear"})]})]}),(0,s.jsxs)("div",{className:"md:w-[75%] h-[90%] md:overflow-scroll custom-scrollbar text-white shadow-xl rounded-xl bg-[#212e3f] gap-4 p-3 md:p-5",children:[(0,s.jsx)("div",{className:"mb-2 text-sm text-white/60",children:"Live preview from website with frames"}),(0,s.jsxs)("div",{className:"relative w-full h-[720px] md:h-full border border-white/10 bg-white rounded-xl overflow-hidden",children:[""!==t&&(0,s.jsx)("div",{className:"relative aspect-video inset-0 w-full z-30 h-full pointer-events-none",children:(0,s.jsx)(d.A,{show:!0,frameSrc:t})}),(0,s.jsx)("iframe",{ref:e,src:"/",title:"Website Live Preview",className:"absolute inset-0 w-full h-full"})]})]}),(0,s.jsx)(i,{open:f,onClose:()=>p(!1),onCreate:k}),(0,s.jsx)(c.A,{snackbarSettings:C,setSnackbarSettings:I})]})}},5381:(e,t,l)=>{"use strict";l.d(t,{J:()=>o,UserProvider:()=>i});var s=l(5155),n=l(2115),r=l(6414);let a=(0,n.createContext)(void 0);function i(e){let{children:t,initialUser:l=null,initialProfile:i=null}=e,[o,c]=(0,n.useState)(l),[d,u]=(0,n.useState)(i),[m,h]=(0,n.useState)(!l),f=async()=>{h(!0);try{let{data:{user:e}}=await r.N.auth.getUser();if(c(null!=e?e:null),e){let{data:t,error:l}=await r.N.from("profiles").select("id, display_name, role, disabled, created_at").eq("id",e.id).single();l?u(null):u(t)}else u(null)}finally{h(!1)}};(0,n.useEffect)(()=>{l||f();let{data:e}=r.N.auth.onAuthStateChange(async(e,t)=>{var l;if(c(null!=(l=null==t?void 0:t.user)?l:null),null==t?void 0:t.user){let{data:e}=await r.N.from("profiles").select("id, display_name, role, disabled, created_at").eq("id",t.user.id).single();u(null!=e?e:null)}else u(null)});return()=>e.subscription.unsubscribe()},[]);let p=(0,n.useMemo)(()=>{var e,t,l;let s=null!=(t=null==o||null==(e=o.app_metadata)?void 0:e.role)?t:"user";return null!=(l=null==d?void 0:d.role)?l:s},[null==d?void 0:d.role,null==o?void 0:o.app_metadata]),v=(0,n.useMemo)(()=>({user:o,profile:d,role:p,loading:m,refresh:f,signOut:async()=>{await r.N.auth.signOut()}}),[o,d,p,m]);return(0,s.jsx)(a.Provider,{value:v,children:t})}function o(){let e=(0,n.useContext)(a);if(!e)throw Error("useUser must be used within <UserProvider>");return e}},6414:(e,t,l)=>{"use strict";l.d(t,{N:()=>s});let s=(0,l(3254).createBrowserClient)("https://enadqzzfyywsbictfwvg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs")},7153:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var s=l(5155),n=l(6766);function r(e){let{show:t,frameSrc:l}=e;return!1===t?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.default,{unoptimized:!0,src:l,alt:"sample",fill:!0,className:"object-fill object-center"})})}},7217:(e,t,l)=>{"use strict";l.d(t,{$h:()=>m,Ah:()=>a,E2:()=>r,EY:()=>c,Hz:()=>n,IH:()=>h,Nb:()=>i,QP:()=>d,Rs:()=>v,dT:()=>x,oS:()=>g,ox:()=>o,sH:()=>p,tX:()=>f,zM:()=>w});var s=l(5155);l(2115);let n=e=>{let{imageUrl:t,onFileSelect:l,onDrop:n,onDragOver:r,onPickClick:a,inputRef:i}=e;return(0,s.jsxs)("div",{className:"border border-dashed rounded-xl h-32 flex items-center justify-center relative hover:border-white/60 transition-colors cursor-pointer group",onClick:a,onDrop:n,onDragOver:r,title:"Click, drag & drop, or paste an image",children:[t?(0,s.jsx)("img",{src:t,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl"}):(0,s.jsxs)("div",{className:"text-center text-white/70 px-4",children:[(0,s.jsx)("div",{className:"text-sm",children:"Image Upload"}),(0,s.jsx)("div",{className:"text-xs mt-1 opacity-80",children:"Click, drag & drop, or paste"})]}),(0,s.jsx)("div",{className:"absolute inset-0 rounded-xl ring-0 group-hover:ring-2 ring-white/10 pointer-events-none"}),(0,s.jsx)("input",{ref:i,type:"file",accept:"image/*",onChange:l,className:"hidden"})]})};async function r(e){let{setEvents:t,setLoadingEvents:l}=e;l(!0);try{var s,n;let e=await fetch("/api/events",{cache:"no-store"}),l=await e.json();if(console.log(l,"fetched data for homepage"),console.log("ANON key fingerprint:",(s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs",void 0===s)?void 0:s.slice(0,6),"…",(n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs",void 0===n)?void 0:n.slice(-6)),!e.ok)throw Error((null==l?void 0:l.error)||"Failed to load events");let r=(l.items||[]).sort((e,t)=>{var l,s;return(null!=(l=e.order)?l:0)-(null!=(s=t.order)?s:0)});t(r)}catch(e){console.error(e)}finally{l(!1)}}async function a(e){let{setEvents:t,setLoadingEvents:l}=e;l(!0);try{let e=await fetch("/api/admin/events",{cache:"no-store"}),l=await e.json();if(!e.ok)throw Error((null==l?void 0:l.error)||"Failed to load events");let s=(l.items||[]).sort((e,t)=>{var l,s;return(null!=(l=e.order)?l:0)-(null!=(s=t.order)?s:0)});t(s)}catch(e){console.error(e)}finally{l(!1)}}async function i(e){let{setSeasons:t,setLoading:l}=e;try{null==l||l(!0);let e=await fetch("/api/seasons",{cache:"no-store"}),s=await e.json();if(!e.ok)throw Error((null==s?void 0:s.error)||"Failed to load seasons");let n=Array.isArray(null==s?void 0:s.items)?s.items:[];return t(n),n}catch(e){return console.error(e),t([]),[]}finally{null==l||l(!1)}}function o(e){let{label:t,value:l,onChange:n,placeholder:r}=e;return(0,s.jsxs)("label",{className:"block",children:[(0,s.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,s.jsx)("input",{value:l,onChange:e=>n(e.target.value),placeholder:r,className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})}function c(e){let{label:t,value:l,onChange:n,placeholder:r,rows:a=5}=e;return(0,s.jsxs)("label",{className:"block",children:[(0,s.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,s.jsx)("textarea",{value:l,maxLength:500,onChange:e=>n(e.target.value),placeholder:r,rows:a,className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30 resize-y"})]})}function d(e){let{label:t,value:l,onChange:n,min:r,max:a}=e;return(0,s.jsxs)("label",{className:"block",children:[(0,s.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,s.jsx)("input",{style:{colorScheme:"dark"},type:"date",value:l,min:r,max:a,onChange:e=>n(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})}let u=["all","live","scheduled","expired","hidden"],m=(e,t,l)=>{if(0===t)return l(!1),null!=e?e:[];{var s;console.log({tabIdx:t}),l(!0);let n=null!=(s=u[t])?s:"live";return console.log({wanted:n}),(null!=e?e:[]).filter(e=>(e=>{if(null==e?void 0:e.computed_status)return e.computed_status;if(!(null==e?void 0:e.published))return"hidden";let t=Date.now(),l=(null==e?void 0:e.publish_at)?new Date(e.publish_at).getTime():null,s=(null==e?void 0:e.unpublish_at)?new Date(e.unpublish_at).getTime():null;return l&&l>t?"scheduled":s&&s<=t?"expired":"live"})(e)===n)}};function h(e){let{publishModal:t,forceOpen:l,startDate:s,endDate:n}=e;if(!t)return!1;if(l)return!0;let r=new Date,a=s?function(e){let t=new Date(e);return t.setHours(0,0,0,0),t}(new Date(s)):new Date(0),i=n?function(e){let t=new Date(e);return t.setHours(23,59,59,999),t}(new Date(n)):new Date(864e13);return r>=a&&r<=i}function f(e,t){if(!e&&!t)return"";if(e&&!t)return b(e);if(!e&&t)return b(t);let l=new Date(e),s=new Date(t);if(isNaN(l.getTime())||isNaN(s.getTime()))return"";if(l.getFullYear()===s.getFullYear()&&l.getMonth()===s.getMonth()){let e=l.toLocaleString(void 0,{month:"short"});return"".concat(e," ").concat(l.getDate(),"–").concat(s.getDate(),", ").concat(l.getFullYear())}return"".concat(b(e)," – ").concat(b(t))}function p(e,t){let l=v(e),s=v(t);return l||s?l&&!s?l:!l&&s?s:"".concat(l," – ").concat(s):""}function v(e,t){var l;let s=function(e){var t,l;if(!(null==e?void 0:e.trim()))return null;let s=/^(\d{1,2})(?::(\d{1,2}))?(?::(\d{1,2})(?:\.\d+)?)?$/.exec(e.trim());if(!s)return null;let n=Number(s[1]),r=Number(null!=(t=s[2])?t:"0"),a=Number(null!=(l=s[3])?l:"0");return Number.isNaN(n)||Number.isNaN(r)||Number.isNaN(a)||n<0||n>23||r<0||r>59||a<0||a>59?null:{h:n,m:r}}(e);if(!s)return"";let n=s.h%12;0===n&&(n=12);let r=s.h<12?"am":"pm",a=(null==t?void 0:t.upper)?r.toUpperCase():r;return"".concat(n,":").concat((l=s.m)<10?"0".concat(l):String(l)," ").concat(a)}function x(e){return e?new Date(e).toISOString():null}let g=e=>{if(!e)return"";let t=new Date(e),l=e=>String(e).padStart(2,"0");return"".concat(t.getFullYear(),"-").concat(l(t.getMonth()+1),"-").concat(l(t.getDate()),"T").concat(l(t.getHours()),":").concat(l(t.getMinutes()))};function b(e){let t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function w(e){return new Promise((t,l)=>{let s=new FileReader;s.onload=()=>t(String(s.result)),s.onerror=l,s.readAsDataURL(e)})}},7857:(e,t,l)=>{"use strict";l.d(t,{A:()=>r});var s=l(7515),n=l(5155);let r=(0,s.A)((0,n.jsx)("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4z"}),"Refresh")},9626:(e,t,l)=>{Promise.resolve().then(l.bind(l,5318))}},e=>{e.O(0,[254,766,19,834,313,441,964,358],()=>e(e.s=9626)),_N_E=e.O()}]);