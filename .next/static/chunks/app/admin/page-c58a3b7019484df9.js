(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{528:(e,t,l)=>{"use strict";l.d(t,{B:()=>o});var a=l(5155);l(2115);var n=l(6766),r=l(8882),i=l(5808),s=l(7149);function o(e){let{open:t,src:l,alt:o="",onClose:d,imageRef:c}=e;return(0,a.jsx)(r.A,{open:t,onClose:d,maxWidth:!1,PaperProps:{sx:{bgcolor:"transparent",boxShadow:"none",borderRadius:2}},children:(0,a.jsx)(i.A,{sx:{p:0,position:"relative",width:{xs:"95vw",sm:"90vw"},height:{xs:"80vh",sm:"85vh"},overflow:"hidden",bgcolor:"transparent"},children:(0,a.jsx)(s.A,{sx:{position:"relative",width:"100%",height:"100%"},children:(0,a.jsx)(n.default,{ref:c,src:l,alt:o,fill:!0,sizes:"100vw",priority:!0,className:"object-contain object-center"})})})})}},1247:(e,t,l)=>{Promise.resolve().then(l.bind(l,3497))},3497:(e,t,l)=>{"use strict";l.d(t,{default:()=>y});var a=l(5155),n=l(2115),r=l(6217),i=l(7149),s=l(9267),o=l(5715),d=l(3127),c=l(4426),u=l(2114),h=l(6673),m=l(1005),x=l(7857),p=l(644),g=l(5294),v=l(7365),f=l(3649),b=l(7217);function w(e){let{status:t}=e,l={live:"Live",scheduled:"Scheduled",expired:"Expired",hidden:"Hidden"};return(0,a.jsx)("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ".concat({live:"bg-green-600/15 text-green-300 ring-1 ring-green-500/30",scheduled:"bg-blue-600/15  text-blue-300  ring-1 ring-blue-500/30",expired:"bg-red-600/15   text-red-300   ring-1 ring-red-500/30",hidden:"bg-zinc-600/15  text-zinc-300  ring-1 ring-zinc-500/30"}[t]),title:l[t],"aria-label":"Status: ".concat(l[t]),children:l[t]})}var j=l(3114);function y(){var e,t,l,y,N,S,k,C,_,A;let[E,D]=(0,n.useState)(!1),[I,T]=(0,n.useState)(""),[M,z]=(0,n.useState)(""),[L,O]=(0,n.useState)(""),[R,P]=(0,n.useState)(null),[U,J]=(0,n.useState)(null),[H,Y]=(0,n.useState)(""),[F,W]=(0,n.useState)(""),[B,X]=(0,n.useState)(""),[Z,V]=(0,n.useState)(""),[Q,G]=(0,n.useState)(!1),[$,K]=(0,n.useState)(""),[q,ee]=(0,n.useState)(""),[et,el]=(0,n.useState)(!0),[ea,en]=(0,n.useState)(!0),[er,ei]=(0,n.useState)(""),[es,eo]=(0,n.useState)(""),[ed,ec]=(0,n.useState)(null),[eu,eh]=(0,n.useState)(0),[em,ex]=(0,n.useState)([]),[ep,eg]=(0,n.useState)(!1),[ev,ef]=(0,n.useState)(""),[eb,ew]=(0,n.useState)({id:"",title:"",subheading:"",description:"",start_date:"",end_date:"",start_time:"",end_time:"",cta_label:"",cta_href:"",image_url:"",image_path:"",order:0}),[ej,ey]=(0,n.useState)(!1),[eN,eS]=(0,n.useState)(!1),[ek,eC]=(0,n.useState)(!1),[e_,eA]=(0,n.useState)({open:!1,message:"",severity:""}),[eE,eD]=(0,n.useState)(null),[eI,eT]=(0,n.useState)(0),[eM,ez]=(0,n.useState)(!1),eL="cmsDraft_v1",eO=(0,n.useRef)(null),eR=(0,n.useRef)(null),[eP,eU]=(0,n.useState)(!1);function eJ(e){P(e),J(URL.createObjectURL(e))}function eH(){T(""),z(""),O(""),Y(""),W(""),X(""),el(!0),en(!0),ei(""),eo(""),P(null),J(null),localStorage.removeItem(eL),ef(""),ew({id:""}),eS(!1),V(""),G(!1),K(""),ee("")}async function eY(){try{eC(!0);let e=em.map(e=>e.id),t=await fetch("/api/admin/events/reorder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:e})}),l=await t.json();if(t.ok)eA(e=>({...e,open:!0,message:"Event Order Saved",severity:"success"}));else throw eA(e=>({...e,open:!0,message:"Event Reorder failed",severity:"error"})),Error((null==l?void 0:l.error)||"Reorder failed");ey(!1)}catch(e){eA(t=>({...t,open:!0,message:e instanceof Error?e.message:"Event Reorder failed",severity:"error"}))}eC(!1)}async function eF(){eC(!0);try{let e,t;if(!(null==I?void 0:I.trim()))return void eA(e=>({...e,open:!0,message:"Title Needed",severity:"error"}));let l=new FormData;if(l.append("title",I),l.append("subheading",M),l.append("description",L),l.append("start_date",H||""),l.append("end_date",F||""),l.append("start_time",B||""),l.append("end_time",Z||""),l.append("cta_label",er||""),l.append("cta_href",es||""),l.append("published",String(Q)),l.append("publish_at",(0,b.dT)($)||""),l.append("unpublish_at",(0,b.dT)(q)||""),R&&l.append("image",R),ed&&0!==eu){if(e=await fetch("/api/admin/events/".concat(ed),{method:"PATCH",body:l,credentials:"include"}),t=await e.json(),!e.ok)throw eA(e=>({...e,open:!0,message:"Event Update failed",severity:"error"})),Error((null==t?void 0:t.error)||"Update failed");eA(e=>({...e,open:!0,message:"Event Updated Successfully",severity:"success"}))}else{if(e=await fetch("/api/admin/events",{method:"POST",body:l,credentials:"include"}),t=await e.json(),!e.ok)throw eA(e=>({...e,open:!0,message:"Event Creation failed",severity:"error"})),Error((null==t?void 0:t.error)||"Create failed");let a=localStorage.getItem(eL),n=a?JSON.parse(a):{};localStorage.setItem(eL,JSON.stringify({...n,eventId:t.id})),0===eu&&eA(e=>({...e,open:!0,message:"Event Created Successfully",severity:"success"}))}0!==eu&&await (0,b.Ah)({setEvents:ex,setLoadingEvents:eg}),(null==t?void 0:t.image_url)&&J(t.image_url)}catch(e){eA(t=>({...t,open:!0,message:e instanceof Error?e.message:"Save failed",severity:"error"}))}finally{eC(!1),eH()}}async function eW(e){eD(e),eA({open:!0,message:"Are you sure you want to delete this event?",severity:"warning",actionLabel:"Delete",duration:1e4,actionCallback:async()=>{try{let t=await fetch("/api/admin/events/".concat(e),{method:"DELETE"}),l=await t.json();if(t.ok)eA({open:!0,message:"Event Deleted Successfully",severity:"success"}),ex(t=>t.filter(t=>t.id!==e)),ed===e&&ec(null);else throw eA({open:!0,message:"Delete Event failed",severity:"error"}),Error((null==l?void 0:l.error)||"Delete failed")}catch(e){eA({open:!0,message:e instanceof Error?e.message:"Delete failed",severity:"error"})}finally{eD(null)}}})}(0,n.useEffect)(()=>D(!0),[]),(0,n.useEffect)(()=>eU(!0),[]),(0,n.useEffect)(()=>{try{var e,t,l,a,n;let r=localStorage.getItem(eL);if(!r)return;let i=JSON.parse(r);T(i.title||""),z(i.subheading||""),O(i.description||""),Y(i.startDate||""),W(i.endDate||""),X(i.startTime||""),V(i.endTime||""),el(null==(e=i.publishModal)||e),en(null==(t=i.forceOpen)||t),ei(i.ctaLabel||""),eo(i.ctaHref||""),G(null==(l=i.published)||l),K(null!=(a=i.publishAt)?a:""),ee(null!=(n=i.unpublishAt)?n:""),i.imageDataUrl&&J(i.imageDataUrl)}catch(e){}},[]),(0,n.useEffect)(()=>{let e=setTimeout(async()=>{try{let e=U;!e&&R&&(e=await (0,b.zM)(R),J(e)),localStorage.setItem(eL,JSON.stringify({title:I,subheading:M,description:L,startDate:H,endDate:F,startTime:B,endTime:Z,publishModal:et,forceOpen:ea,ctaLabel:er,ctaHref:es,imageDataUrl:e,published:Q,publishAt:$,unpublishAt:q}))}catch(e){}},300);return()=>clearTimeout(e)},[I,M,L,H,F,B,Z,et,ea,er,es,R,U,Q,$,q]),(0,n.useEffect)(()=>{let e=setTimeout(()=>{var e,t,l;let a=U&&U.startsWith("data:")?U:null;if(!a)try{let e=localStorage.getItem(eL);a=e&&null!=(l=JSON.parse(e).imageDataUrl)?l:null}catch(e){}let n={title:I,subheading:M,description:L,startDate:H,endDate:F,startTime:B,endTime:Z,publishModal:et,forceOpen:ea,ctaLabel:er,ctaHref:es,imageDataUrl:a};null==(t=eR.current)||null==(e=t.contentWindow)||e.postMessage({type:"cms:update",payload:n},window.location.origin)},120);return()=>clearTimeout(e)},[I,M,L,H,F,B,Z,et,ea,er,es,U]),(0,n.useEffect)(()=>{function e(e){if(!e.clipboardData)return;let t=Array.from(e.clipboardData.items).find(e=>e.type.startsWith("image/"));if(!t)return;let l=t.getAsFile();l&&eJ(l)}return window.addEventListener("paste",e),()=>window.removeEventListener("paste",e)},[]),(0,n.useEffect)(()=>{0!==eu&&(0,b.Ah)({setEvents:ex,setLoadingEvents:eg})},[eu]),console.log("time",(0,b.dT)($),$+":00.000Z"),console.log("utctest",(0,b.oS)((0,b.dT)($))),(0,n.useEffect)(()=>()=>{eC(!1)},[]),console.log(eb),console.log("id",ed);let eB=em.map(e=>{var t,l,a,n,r,i;return{id:e.id,imageUrl:null!=(t=e.image_url)?t:void 0,title:null!=(l=e.title)?l:"(untitled)",subheading:null!=(a=e.subheading)?a:"",description:null!=(n=e.description)?n:"",dateRange:(0,b.tX)(e.start_date,e.end_date),timeText:(0,b.sH)(e.start_time,e.end_time),ctaLabel:null!=(r=e.cta_label)?r:"",ctaHref:null!=(i=e.cta_href)?i:""}}),eX={id:ed||"new",imageUrl:null!=U?U:void 0,title:(null==I?void 0:I.trim())||"(untitled)",subheading:M||"",description:L||"",dateRange:(0,b.tX)(H,F),timeText:(0,b.sH)(B,Z),ctaLabel:er||"",ctaHref:es||""},eZ=(null!=(S=null==I||null==(e=I.trim())?void 0:e.length)?S:0)>0||(null!=(k=null==M||null==(t=M.trim())?void 0:t.length)?k:0)>0||(null!=(C=null==L||null==(l=L.trim())?void 0:l.length)?C:0)>0||!!H||!!F||!!B||!!Z||(null!=(_=null==er||null==(y=er.trim())?void 0:y.length)?_:0)>0||(null!=(A=null==es||null==(N=es.trim())?void 0:N.length)?A:0)>0||!!U,eV=0===eu?eZ?[eX,...eB]:eB:ev?[eX]:eB,eQ=H&&F&&new Date(F)<new Date(H)?"End date cannot be before start date.":"",eG=(0,b.IH)({publishModal:et,forceOpen:ea,startDate:H,endDate:F}),e$=0===eu||1===eu&&!!ev;(0,n.useEffect)(()=>{0===eu&&eH()},[eu]);let eK=(0,n.useMemo)(()=>(0,b.$h)(em,eI,ez),[em,eI]);return E?(0,a.jsxs)("div",{className:"font-sans flex flex-col gap-4 md:flex-row min-h-screen md:h-screen p-8 md:gap-8 sm:px-20 bg-[#151c2f]",children:[(0,a.jsxs)("div",{className:"md:w-[30%] text-white h-[90%] md:overflow-scroll custom-scrollbar shadow-xl rounded-xl bg-[#212e3f] p-3 md:p-5 space-y-4",children:[(0,a.jsx)(i.A,{sx:{borderBottom:1,borderColor:"rgba(255,255,255,0.1)"},children:(0,a.jsxs)(s.A,{value:eu,onChange:(e,t)=>{eh(t),eH(),ef(""),ex([]),0===t&&ec(null)},variant:"fullWidth",sx:{"& .MuiTab-root":{color:"rgba(255,255,255,0.7)"},"& .Mui-selected":{color:"#fff"},"& .MuiTabs-indicator":{backgroundColor:"#60a5fa"}},children:[(0,a.jsx)(o.A,{label:"Create"}),(0,a.jsx)(o.A,{label:"Update"})]})}),1===eu&&(0,a.jsxs)("div",{className:"space-y-3 ".concat(eN?"hidden":""),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"px-2 text-sm text-white/80",children:"Reorder events (drag rows)"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:eY,disabled:ek||!ej,className:"rounded-md bg-blue-500/90 hover:bg-blue-500 px-3 py-1.5 text-sm disabled:opacity-50 hover:cursor-pointer disabled:cursor-not-allowed",children:ek?(0,a.jsx)("span",{className:"inline-flex items-center px-2 gap-2",children:(0,a.jsxs)("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4A4 4 0 004 12z"})]})}):"Save"}),(0,a.jsx)(d.A,{size:"small",onClick:()=>{(0,b.Ah)({setEvents:ex,setLoadingEvents:eg}),eH()},children:(0,a.jsx)(x.A,{htmlColor:"#9ca3af",fontSize:"small"})})]})]}),(0,a.jsx)("div",{children:(0,a.jsx)(i.A,{sx:{borderBottom:1,borderColor:"rgba(255,255,255,0.1)"},children:(0,a.jsxs)(s.A,{value:eI,onChange:(e,t)=>{eT(t),console.log(t)},variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{"& .MuiTab-root":{color:"rgba(255,255,255,0.7)",fontSize:"12px",px:1.5,textTransform:"none",whiteSpace:"nowrap"},"& .Mui-selected":{color:"#67ff56"},"& .MuiTabs-indicator":{backgroundColor:"#60fa68"},"& .MuiTabs-scrollButtons.Mui-disabled":{opacity:.3}},children:[(0,a.jsx)(o.A,{label:"All"}),(0,a.jsx)(o.A,{label:"Live"}),(0,a.jsx)(o.A,{label:"Scheduled"}),(0,a.jsx)(o.A,{label:"Expired"}),(0,a.jsx)(o.A,{label:"Hidden"})]})})}),ep?(0,a.jsx)("div",{className:"flex justify-center py-4",children:(0,a.jsx)(c.A,{size:20})}):(0,a.jsx)(g.JY,{onDragEnd:function(e){if(!e.destination)return;let t=e.source.index,l=e.destination.index;t!==l&&(ex(e=>{let a=[...e],[n]=a.splice(t,1);return a.splice(l,0,n),a}),ey(!0))},children:(0,a.jsx)(g.gL,{droppableId:"events-order",isDropDisabled:eM,children:e=>(0,a.jsxs)("ul",{ref:e.innerRef,...e.droppableProps,className:"divide-y divide-white/10 rounded-lg h-[150px] md:h-[420px]  overflow-scroll custom-scrollbar",children:[eK.map((e,t)=>(0,a.jsx)(g.sx,{draggableId:e.id,index:t,isDragDisabled:eM,children:t=>{var l;return(0,a.jsxs)("li",{ref:t.innerRef,...t.draggableProps,className:"flex items-center justify-between even:bg-[#151c2f] p-2  hover:bg-white/10",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{...t.dragHandleProps,className:"text-white/60 cursor-grab active:cursor-grabbing",title:"Drag to reorder",children:(0,a.jsx)(v.A,{fontSize:"small"})}),(0,a.jsx)("span",{className:"text-white hover:cursor-pointer truncate max-w-[70px] md:max-w-[150px]",onClick:()=>{let t=e.id,l=em.find(e=>e.id===t);console.log("here ev",l),l&&(ec(l.id),T(l.title||""),z(l.subheading||""),O(l.description||""),Y(l.start_date||""),W(l.end_date||""),X(l.start_time||""),V(l.end_time||""),ei(l.cta_label||""),eo(l.cta_href||""),J(l.image_url||null),G(!!l.published),K((0,b.oS)(l.publish_at)||""),ee((0,b.oS)(l.unpublish_at)||""))},children:e.title||"(untitled)"})]}),(0,a.jsxs)("span",{className:"text-xs text-white/40",children:[(0,a.jsx)(w,{status:null!=(l=e.computed_status)?l:"hidden"}),(0,a.jsx)(d.A,{"aria-label":"delete",onClick:()=>{eS(!0),ef(e.id);let t=e.id,l=em.find(e=>e.id===t);if(l){var a;ec(l.id),T(l.title||""),z(l.subheading||""),O(l.description||""),Y(l.start_date||""),W(l.end_date||""),X(l.start_time||""),V(l.end_time||""),ei(l.cta_label||""),eo(l.cta_href||""),J(l.image_url||null),G(null!=(a=l.published)&&a),K((0,b.oS)(l.publish_at)||""),ee((0,b.oS)(l.unpublish_at)||"")}},children:(0,a.jsx)(p.A,{className:"text-green-400 hover:text-green-500 transition duration-700 ease-in-out"})}),(0,a.jsx)(d.A,{"aria-label":"delete",onClick:()=>{eW(e.id)},children:(0,a.jsx)(m.A,{className:"text-red-400 hover:text-red-500 transition duration-700 ease-in-out"})})]})]})}},e.id)),e.placeholder,0===em.length&&(0,a.jsx)("li",{className:"p-3 text-sm text-white/60",children:"No events yet."})]})})})]}),eN&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{size:"small",onClick:()=>{ef(""),eH(),(0,b.Ah)({setEvents:ex,setLoadingEvents:eg})},children:(0,a.jsx)("div",{className:"border border-[rgba(255,255,255,0.1)] flex justify-center items-center p-2 rounded hover:bg-white/10 transition duration-300 ease-in-out",children:(0,a.jsx)(j.A,{htmlColor:"#9ca3af",fontSize:"small"})})}),(0,a.jsxs)(u.A,{fullWidth:!0,displayEmpty:!0,size:"small",value:ev,onChange:e=>{let t=String(e.target.value);ef(t);let l=em.find(e=>e.id===t);l&&(ew(l),ec(l.id),T(l.title||""),z(l.subheading||""),O(l.description||""),Y(l.start_date||""),W(l.end_date||""),X(l.start_time||""),V(l.end_time||""),ei(l.cta_label||""),eo(l.cta_href||""),J(l.image_url||null),G(!!l.published),K((0,b.oS)(l.publish_at)||""),ee((0,b.oS)(l.unpublish_at)||""))},sx:{color:"#fff","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255,255,255,0.15)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255,255,255,0.3)"}},renderValue:e=>{var t;return e?(null==(t=em.find(t=>t.id===e))?void 0:t.title)||"---":"Select event…"},children:[ep&&(0,a.jsxs)(h.A,{disabled:!0,children:[(0,a.jsx)(c.A,{size:16,sx:{mr:1}})," Loading…"]}),!ep&&0===em.length&&(0,a.jsx)(h.A,{disabled:!0,children:"No events yet"}),em.map(e=>(0,a.jsx)(h.A,{value:e.id,children:e.title||"(untitled)"},e.id))]})]}),(0,a.jsx)("div",{className:"text-xs text-white/60",children:ev?"Editing: ".concat(ev):"Pick an event to edit"})]}),e$&&(0,a.jsxs)("div",{className:"md:h-[90%] overflow-scroll custom-scrollbar",children:[(0,a.jsx)(b.Hz,{imageUrl:null!=U?U:void 0,onPickClick:function(){var e;null==(e=eO.current)||e.click()},onFileSelect:function(e){var t;let l=null==(t=e.target.files)?void 0:t[0];l&&eJ(l)},onDrop:function(e){var t;e.preventDefault();let l=null==(t=e.dataTransfer.files)?void 0:t[0];l&&l.type.startsWith("image/")&&eJ(l)},onDragOver:function(e){e.preventDefault()},inputRef:eO}),(0,a.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,a.jsx)(b.ox,{label:"Title",value:I,onChange:T,placeholder:"Enter title"}),(0,a.jsx)(b.ox,{label:"Subheading",value:M,onChange:z,placeholder:"Optional subheading"}),(0,a.jsx)(b.EY,{label:"Description",value:L,onChange:O,placeholder:"Write a short description...",rows:3}),(0,a.jsx)("div",{className:"text-xs text-white/60",children:(0,a.jsxs)("div",{className:"text-end",children:[L.length," chars"]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(b.QP,{label:"Start date",value:H,onChange:Y}),(0,a.jsx)(b.QP,{label:"End date",value:F,onChange:W,min:H||void 0})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 mt-1 gap-2",children:[(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"Start time"}),(0,a.jsx)("input",{style:{colorScheme:"dark"},type:"time",value:B,onChange:e=>X(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"End time"}),(0,a.jsx)("input",{style:{colorScheme:"dark"},type:"time",value:Z,onChange:e=>V(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})]}),eQ&&(0,a.jsx)("div",{className:"text-xs text-red-300",children:eQ}),(0,a.jsxs)("div",{className:"grid grid-cols-2 mt-1 gap-2",children:[(0,a.jsx)(b.ox,{label:"CTA label",value:er,onChange:ei,placeholder:"Learn More"}),(0,a.jsx)(b.ox,{label:"CTA link",value:es,onChange:eo,placeholder:"https://example.com"})]}),(0,a.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-3",children:[(0,a.jsxs)("label",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:Q,onChange:e=>G(e.target.checked)}),(0,a.jsx)("div",{className:"text-sm text-white/80",children:"Published"})]}),(0,a.jsx)("div",{}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"Publish at"}),(0,a.jsx)("input",{style:{colorScheme:"dark"},type:"datetime-local",value:$,onChange:e=>K(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]}),(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"Unpublish at"}),(0,a.jsx)("input",{style:{colorScheme:"dark"},type:"datetime-local",value:q,min:$||void 0,onChange:e=>ee(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-1 pt-2",children:[(0,a.jsx)("button",{onClick:eF,disabled:!eP||ek,className:"px-3 py-2 rounded-lg bg-green-400 hover:bg-green-500 hover:cursor-pointer text-black font-medium disabled:cursor-not-allowed",children:ek?(0,a.jsxs)("span",{className:"inline-flex items-center gap-2",children:[0!==eu&&ed?"Updating…":"Creating…",(0,a.jsxs)("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4A4 4 0 004 12z"})]})]}):0!==eu&&ed?"Update":"Publish"}),(0,a.jsx)("button",{onClick:function(){T(""),z(""),O(""),Y(""),W(""),X(""),ei(""),eo(""),P(null),J(null),localStorage.removeItem(eL),G(!1),K(""),ee("")},className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white hover:cursor-pointer",children:"Clear"})]})]})]}),(0,a.jsxs)("div",{className:"md:w-[70%] h-[90%] md:overflow-scroll custom-scrollbar text-white shadow-xl rounded-xl bg-[#212e3f] gap-4 p-3 md:p-5",children:[(0,a.jsx)("div",{className:"mb-2 text-sm text-white/60",children:"Live preview from website"}),(0,a.jsxs)("div",{className:"relative w-full h-[720px] md:h-full border border-white/10 bg-white rounded-xl overflow-hidden",children:[(0,a.jsx)("iframe",{ref:eR,src:"/",title:"Website Live Preview",className:"absolute inset-0 object-contain h-full w-full"}),(0,a.jsx)(r.A,{container:"contained",open:eG,onClose:()=>{},events:eV,initialIndex:Math.max(0,eV.findIndex(e=>e.id===ed))})]}),(0,a.jsx)("div",{className:"mt-3 flex justify-between items-center border-t border-white/10 pt-3",children:(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:et,onChange:e=>el(e.target.checked)}),(0,a.jsx)("span",{children:"Event popup modal (preview)"})]})})]}),(0,a.jsx)(f.A,{snackbarSettings:e_,setSnackbarSettings:eA})]}):null}},3649:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var a=l(5155),n=l(5726),r=l(2302),i=l(8534);function s(e){let{snackbarSettings:t,setSnackbarSettings:l}=e,{open:s,message:o,severity:d,actionLabel:c,actionCallback:u,duration:h}=t,m=()=>{l(e=>({...e,open:!1,actionLable:null,actionCallback:null}))};return(0,a.jsx)(n.A,{open:s,autoHideDuration:void 0!==h?h:2e3,anchorOrigin:{vertical:"top",horizontal:"center"},onClose:m,children:(0,a.jsx)(r.A,{severity:d,variant:"standard",className:"w-full",onClose:m,action:c&&u?(0,a.jsx)(i.A,{color:"error",size:"small",onClick:()=>{u&&(u(),l(e=>({...e,open:!1})))},children:c}):null,children:o})})}},6217:(e,t,l)=>{"use strict";l.d(t,{A:()=>d});var a=l(5155),n=l(2115),r=l(6766),i=l(6643),s=l(335),o=l(528);function d(e){var t,l,d;let{open:c,onClose:u,events:h,container:m="contained",initialIndex:x=0}=e,[p,g]=(0,n.useState)(()=>{var e;return Math.min(Math.max(x,0),Math.max(0,(null!=(e=null==h?void 0:h.length)?e:1)-1))}),[v,f]=(0,n.useState)(!1);(0,n.useEffect)(()=>{var e;g(Math.min(Math.max(x,0),Math.max(0,(null!=(e=null==h?void 0:h.length)?e:1)-1)))},[h,x,c]),console.log({index:p});let b=(0,n.useRef)([]),w=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=b.current[p];e&&e.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})},[p]),(0,n.useEffect)(()=>{function e(e){e.target===w.current&&f(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,n.useEffect)(()=>{var e;if(c&&!((null!=(e=null==h?void 0:h.length)?e:0)<1))return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t);function t(e){"Escape"===e.key&&u(),"ArrowLeft"===e.key&&g(e=>(e-1+h.length)%h.length),"ArrowRight"===e.key&&g(e=>(e+1)%h.length)}},[c,h,u]);let j=(null!=(t=null==h?void 0:h.length)?t:0)>0;if(!c||!j)return null;let y="contained"===m?"absolute":"fixed",N=h[p];return console.log({current:N}),(0,a.jsxs)("div",{className:"".concat(y," inset-0 ").concat("contained"===m?"z-10":"z-[50]"," flex items-center p-4 lg:p-0 justify-center"),role:"dialog","aria-modal":"true",children:[(0,a.jsx)("div",{className:"".concat(y," inset-0 bg-black/60 backdrop-blur-[1px]"),onClick:u}),(0,a.jsxs)("div",{className:"relative z-10 w-full max-w-[400px] md:max-w-[560px] rounded-2xl bg-white shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{onClick:u,"aria-label":"Close",className:"absolute -right-3 -top-3 flex h-10 w-10 items-center justify-center rounded-full bg-red-500 hover:bg-red-600 text-white shadow-lg cursor-pointer ring-4 ring-white",children:"\xd7"}),h.length>1&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{"aria-label":"Previous",onClick:()=>g(e=>(e-1+h.length)%h.length),className:"absolute left-2 top-1/2 z-[50] -translate-y-1/2 rounded-full bg-black/30 text-white h-8 w-8 grid place-items-center hover:bg-black/40",children:"‹"}),(0,a.jsx)("button",{"aria-label":"Next",onClick:()=>g(e=>(e+1)%h.length),className:"absolute right-2 top-1/2 z-[50] -translate-y-1/2 rounded-full bg-black/30 text-white h-8 w-8 grid place-items-center hover:bg-black/40",children:"›"})]}),(0,a.jsxs)("div",{className:"px-5 pb-5 pt-6",children:[(null==N?void 0:N.imageUrl)&&(0,a.jsxs)("div",{className:"relative mx-auto mb-4 h-32 w-full overflow-hidden rounded-xl  ".concat("fullscreen"===m?"md:h-60":"md:h-32"),children:[(0,a.jsx)(r.default,{src:N.imageUrl,alt:N.title||"",fill:!0,unoptimized:!0,className:"object-contain object-center bg-black/50 cursor-zoom-in   hover:scale-[1.02] transition-transform duration-300 hover:opacity-70 hover:duration-500",sizes:"(max-width: 640px) 100vw, 560px",priority:!0,onClick:()=>f(!0)}),(0,a.jsx)(o.B,{open:v,src:N.imageUrl||"",alt:N.title||"",imageRef:w,onClose:()=>f(!1)})]}),(0,a.jsx)("h2",{className:"text-center text-neutral-600 text-3xl font-semibold tracking-tight whitespace-pre-wrap break-words [overflow-wrap:anywhere] hyphens-auto",children:null==N?void 0:N.title}),!!(null==N?void 0:N.subheading)&&(0,a.jsx)("p",{className:"mt-1 text-center text-sm text-neutral-600 whitespace-pre-wrap break-words [overflow-wrap:anywhere] hyphens-auto",children:null==N?void 0:N.subheading}),((null==N?void 0:N.dateRange)||(null==N?void 0:N.timeText))&&(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-center gap-5 text-sm text-neutral-700",children:[(null==N?void 0:N.dateRange)&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1.5",children:[(0,a.jsx)(i.A,{sx:{fontSize:20}}),null==N?void 0:N.dateRange]}),(null==N?void 0:N.timeText)&&(0,a.jsxs)("span",{className:"inline-flex items-center gap-1.5",children:[(0,a.jsx)(s.A,{sx:{fontSize:20}}),null==N?void 0:N.timeText]})]}),!!(null==N?void 0:N.description)&&(0,a.jsx)("div",{className:"mt-4 max-h-56 overflow-y-auto",children:(0,a.jsx)("p",{className:"text-sm leading-relaxed text-neutral-800 whitespace-pre-wrap break-words [overflow-wrap:anywhere] hyphens-auto",children:null==N?void 0:N.description})}),((null==N?void 0:N.ctaLabel)||(null==N?void 0:N.ctaHref))&&(0,a.jsx)("div",{className:"mt-6 flex justify-center",children:(null==N?void 0:N.ctaHref)?(0,a.jsx)("a",{href:null==N?void 0:N.ctaHref,target:"_blank",rel:"noreferrer",className:"inline-flex items-center justify-center rounded-full bg-red-600 hover:bg-red-500 hover:shadow-2xl duration-300 px-6 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow hover:opacity-95",children:null!=(l=null==N?void 0:N.ctaLabel)?l:"Learn more"}):(0,a.jsx)("button",{className:"inline-flex items-center justify-center rounded-full bg-red-600 hover:bg-red-500 hover:shadow-2xl duration-300 px-6 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow hover:opacity-95",children:null!=(d=null==N?void 0:N.ctaLabel)?d:"Learn more"})}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"items-center w-[25%] md:w-[15%]",children:h.length>1&&(0,a.jsx)("div",{className:"mt-4 w-full max-w-md mx-auto  overflow-x-scroll custom-scrollbar",children:(0,a.jsx)("div",{className:"flex items-center gap-3 px-2",children:h.map((e,t)=>{let l=t===p;return(0,a.jsx)("button",{ref:e=>{b.current[t]=e},"aria-label":"Go to slide ".concat(t+1),"aria-current":l?"true":void 0,onClick:()=>g(t),className:"\n                            h-2 md:h-3 w-2 md:w-3 rounded-full transition-all duration-300\n                            flex-shrink-0 focus:outline-none\n                            ".concat(l?"bg-neutral-900":"border-neutral-300 bg-neutral-200 hover:bg-neutral-400","\n                          ")},t)})})})})})]})]})]})}},7217:(e,t,l)=>{"use strict";l.d(t,{$h:()=>m,Ah:()=>i,E2:()=>r,EY:()=>c,Hz:()=>n,IH:()=>x,Nb:()=>s,QP:()=>u,dT:()=>f,lP:()=>o,oS:()=>b,ox:()=>d,sH:()=>g,tX:()=>p,zM:()=>j});var a=l(5155);l(2115);let n=e=>{let{imageUrl:t,onFileSelect:l,onDrop:n,onDragOver:r,onPickClick:i,inputRef:s}=e;return(0,a.jsxs)("div",{className:"border border-dashed rounded-xl h-32 flex items-center justify-center relative hover:border-white/60 transition-colors cursor-pointer group",onClick:i,onDrop:n,onDragOver:r,title:"Click, drag & drop, or paste an image",children:[t?(0,a.jsx)("img",{src:t,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl"}):(0,a.jsxs)("div",{className:"text-center text-white/70 px-4",children:[(0,a.jsx)("div",{className:"text-sm",children:"Image Upload"}),(0,a.jsx)("div",{className:"text-xs mt-1 opacity-80",children:"Click, drag & drop, or paste"})]}),(0,a.jsx)("div",{className:"absolute inset-0 rounded-xl ring-0 group-hover:ring-2 ring-white/10 pointer-events-none"}),(0,a.jsx)("input",{ref:s,type:"file",accept:"image/*",onChange:l,className:"hidden"})]})};async function r(e){let{setEvents:t,setLoadingEvents:l}=e;l(!0);try{var a,n;let e=await fetch("/api/events",{cache:"no-store"}),l=await e.json();if(console.log(l,"fetched data for homepage"),console.log("ANON key fingerprint:",(a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs",void 0===a)?void 0:a.slice(0,6),"…",(n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs",void 0===n)?void 0:n.slice(-6)),!e.ok)throw Error((null==l?void 0:l.error)||"Failed to load events");let r=(l.items||[]).sort((e,t)=>{var l,a;return(null!=(l=e.order)?l:0)-(null!=(a=t.order)?a:0)});t(r)}catch(e){console.error(e)}finally{l(!1)}}async function i(e){let{setEvents:t,setLoadingEvents:l}=e;l(!0);try{let e=await fetch("/api/admin/events",{cache:"no-store"}),l=await e.json();if(!e.ok)throw Error((null==l?void 0:l.error)||"Failed to load events");let a=(l.items||[]).sort((e,t)=>{var l,a;return(null!=(l=e.order)?l:0)-(null!=(a=t.order)?a:0)});t(a)}catch(e){console.error(e)}finally{l(!1)}}async function s(e){let{setSeasons:t,setLoading:l}=e;try{null==l||l(!0);let e=await fetch("/api/seasons",{cache:"no-store"}),a=await e.json();if(!e.ok)throw Error((null==a?void 0:a.error)||"Failed to load seasons");let n=Array.isArray(null==a?void 0:a.items)?a.items:[];return t(n),n}catch(e){return console.error(e),t([]),[]}finally{null==l||l(!1)}}async function o(e){let{setHotspots:t,setLoading:l}=e;try{null==l||l(!0);let e=await fetch("/api/hotspots",{cache:"no-store"}),a=await e.json();if(!e.ok)throw Error((null==a?void 0:a.error)||"Failed to load seasons");let n=Array.isArray(null==a?void 0:a.items)?a.items:[];return t(n),n}catch(e){return console.error(e),t([]),[]}finally{null==l||l(!1)}}function d(e){let{label:t,value:l,onChange:n,placeholder:r}=e;return(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,a.jsx)("input",{value:l,onChange:e=>n(e.target.value),placeholder:r,className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})}function c(e){let{label:t,value:l,onChange:n,placeholder:r,rows:i=5}=e;return(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,a.jsx)("textarea",{value:l,maxLength:500,onChange:e=>n(e.target.value),placeholder:r,rows:i,className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30 resize-y"})]})}function u(e){let{label:t,value:l,onChange:n,min:r,max:i}=e;return(0,a.jsxs)("label",{className:"block",children:[(0,a.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,a.jsx)("input",{style:{colorScheme:"dark"},type:"date",value:l,min:r,max:i,onChange:e=>n(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})}let h=["all","live","scheduled","expired","hidden"],m=(e,t,l)=>{if(0===t)return l(!1),null!=e?e:[];{var a;console.log({tabIdx:t}),l(!0);let n=null!=(a=h[t])?a:"live";return console.log({wanted:n}),(null!=e?e:[]).filter(e=>(e=>{if(null==e?void 0:e.computed_status)return e.computed_status;if(!(null==e?void 0:e.published))return"hidden";let t=Date.now(),l=(null==e?void 0:e.publish_at)?new Date(e.publish_at).getTime():null,a=(null==e?void 0:e.unpublish_at)?new Date(e.unpublish_at).getTime():null;return l&&l>t?"scheduled":a&&a<=t?"expired":"live"})(e)===n)}};function x(e){let{publishModal:t,forceOpen:l,startDate:a,endDate:n}=e;if(!t)return!1;if(l)return!0;let r=new Date,i=a?function(e){let t=new Date(e);return t.setHours(0,0,0,0),t}(new Date(a)):new Date(0),s=n?function(e){let t=new Date(e);return t.setHours(23,59,59,999),t}(new Date(n)):new Date(864e13);return r>=i&&r<=s}function p(e,t){if(!e&&!t)return"";if(e&&!t)return w(e);if(!e&&t)return w(t);let l=new Date(e),a=new Date(t);if(isNaN(l.getTime())||isNaN(a.getTime()))return"";if(l.getFullYear()===a.getFullYear()&&l.getMonth()===a.getMonth()){let e=l.toLocaleString(void 0,{month:"short"});return"".concat(e," ").concat(l.getDate(),"–").concat(a.getDate(),", ").concat(l.getFullYear())}return"".concat(w(e)," – ").concat(w(t))}function g(e,t){let l=v(e),a=v(t);return l||a?l&&!a?l:!l&&a?a:"".concat(l," – ").concat(a):""}function v(e,t){var l;let a=function(e){var t,l;if(!(null==e?void 0:e.trim()))return null;let a=/^(\d{1,2})(?::(\d{1,2}))?(?::(\d{1,2})(?:\.\d+)?)?$/.exec(e.trim());if(!a)return null;let n=Number(a[1]),r=Number(null!=(t=a[2])?t:"0"),i=Number(null!=(l=a[3])?l:"0");return Number.isNaN(n)||Number.isNaN(r)||Number.isNaN(i)||n<0||n>23||r<0||r>59||i<0||i>59?null:{h:n,m:r}}(e);if(!a)return"";let n=a.h%12;0===n&&(n=12);let r=a.h<12?"am":"pm",i=(null==t?void 0:t.upper)?r.toUpperCase():r;return"".concat(n,":").concat((l=a.m)<10?"0".concat(l):String(l)," ").concat(i)}function f(e){return e?new Date(e).toISOString():null}let b=e=>{if(!e)return"";let t=new Date(e),l=e=>String(e).padStart(2,"0");return"".concat(t.getFullYear(),"-").concat(l(t.getMonth()+1),"-").concat(l(t.getDate()),"T").concat(l(t.getHours()),":").concat(l(t.getMinutes()))};function w(e){let t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function j(e){return new Promise((t,l)=>{let a=new FileReader;a.onload=()=>t(String(a.result)),a.onerror=l,a.readAsDataURL(e)})}}},e=>{e.O(0,[1309,6766,8019,4834,4033,8406,6511,8441,5964,7358],()=>e(e.s=1247)),_N_E=e.O()}]);