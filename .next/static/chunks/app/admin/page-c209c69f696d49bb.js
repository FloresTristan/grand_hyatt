(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{528:(e,t,l)=>{"use strict";l.d(t,{B:()=>o});var n=l(5155);l(2115);var a=l(6766),r=l(8882),i=l(5808),s=l(7149);function o(e){let{open:t,src:l,alt:o="",onClose:c,imageRef:d}=e;return(0,n.jsx)(r.A,{open:t,onClose:c,maxWidth:!1,PaperProps:{sx:{bgcolor:"transparent",boxShadow:"none",borderRadius:2}},children:(0,n.jsx)(i.A,{sx:{p:0,position:"relative",width:{xs:"95vw",sm:"90vw"},height:{xs:"80vh",sm:"85vh"},overflow:"hidden",bgcolor:"transparent"},children:(0,n.jsx)(s.A,{sx:{position:"relative",width:"100%",height:"100%"},children:(0,n.jsx)(a.default,{ref:d,src:l,alt:o,fill:!0,sizes:"100vw",priority:!0,className:"object-contain object-center"})})})})}},1247:(e,t,l)=>{Promise.resolve().then(l.bind(l,6666))},3649:(e,t,l)=>{"use strict";l.d(t,{A:()=>s});var n=l(5155),a=l(5726),r=l(2302),i=l(8534);function s(e){let{snackbarSettings:t,setSnackbarSettings:l}=e,{open:s,message:o,severity:c,actionLabel:d,actionCallback:u,duration:h}=t,m=()=>{l(e=>({...e,open:!1,actionLable:null,actionCallback:null}))};return(0,n.jsx)(a.A,{open:s,autoHideDuration:void 0!==h?h:2e3,anchorOrigin:{vertical:"top",horizontal:"center"},onClose:m,children:(0,n.jsx)(r.A,{severity:c,variant:"standard",className:"w-full",onClose:m,action:d&&u?(0,n.jsx)(i.A,{color:"error",size:"small",onClick:()=>{u&&(u(),l(e=>({...e,open:!1})))},children:d}):null,children:o})})}},6217:(e,t,l)=>{"use strict";l.d(t,{A:()=>c});var n=l(5155),a=l(2115),r=l(6766),i=l(6643),s=l(335),o=l(528);function c(e){var t,l,c;let{open:d,onClose:u,events:h,container:m="contained",initialIndex:x=0}=e,[p,g]=(0,a.useState)(()=>{var e;return Math.min(Math.max(x,0),Math.max(0,(null!=(e=null==h?void 0:h.length)?e:1)-1))}),[v,f]=(0,a.useState)(!1);(0,a.useEffect)(()=>{var e;g(Math.min(Math.max(x,0),Math.max(0,(null!=(e=null==h?void 0:h.length)?e:1)-1)))},[h,x,d]),console.log({index:p});let b=(0,a.useRef)([]),w=(0,a.useRef)(null);(0,a.useEffect)(()=>{let e=b.current[p];e&&e.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})},[p]),(0,a.useEffect)(()=>{function e(e){e.target===w.current&&f(!1)}return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,a.useEffect)(()=>{var e;if(d&&!((null!=(e=null==h?void 0:h.length)?e:0)<1))return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t);function t(e){"Escape"===e.key&&u(),"ArrowLeft"===e.key&&g(e=>(e-1+h.length)%h.length),"ArrowRight"===e.key&&g(e=>(e+1)%h.length)}},[d,h,u]);let j=(null!=(t=null==h?void 0:h.length)?t:0)>0;if(!d||!j)return null;let y="contained"===m?"absolute":"fixed",N=h[p];return console.log({current:N}),(0,n.jsxs)("div",{className:"".concat(y," inset-0 ").concat("contained"===m?"z-10":"z-[50]"," flex items-center p-4 lg:p-0 justify-center"),role:"dialog","aria-modal":"true",children:[(0,n.jsx)("div",{className:"".concat(y," inset-0 bg-black/60 backdrop-blur-[1px]"),onClick:u}),(0,n.jsxs)("div",{className:"relative z-10 w-full max-w-[400px] md:max-w-[560px] rounded-2xl bg-white shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("button",{onClick:u,"aria-label":"Close",className:"absolute -right-3 -top-3 flex h-10 w-10 items-center justify-center rounded-full bg-red-500 hover:bg-red-600 text-white shadow-lg cursor-pointer ring-4 ring-white",children:"\xd7"}),h.length>1&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{"aria-label":"Previous",onClick:()=>g(e=>(e-1+h.length)%h.length),className:"absolute left-2 top-1/2 z-[50] -translate-y-1/2 rounded-full bg-black/30 text-white h-8 w-8 grid place-items-center hover:bg-black/40",children:"‹"}),(0,n.jsx)("button",{"aria-label":"Next",onClick:()=>g(e=>(e+1)%h.length),className:"absolute right-2 top-1/2 z-[50] -translate-y-1/2 rounded-full bg-black/30 text-white h-8 w-8 grid place-items-center hover:bg-black/40",children:"›"})]}),(0,n.jsxs)("div",{className:"px-5 pb-5 pt-6",children:[(null==N?void 0:N.imageUrl)&&(0,n.jsxs)("div",{className:"relative mx-auto mb-4 h-32 w-full overflow-hidden rounded-xl  ".concat("fullscreen"===m?"md:h-60":"md:h-32"),children:[(0,n.jsx)(r.default,{src:N.imageUrl,alt:N.title||"",fill:!0,unoptimized:!0,className:"object-contain object-center bg-black/50 cursor-zoom-in   hover:scale-[1.02] transition-transform duration-300 hover:opacity-70 hover:duration-500",sizes:"(max-width: 640px) 100vw, 560px",priority:!0,onClick:()=>f(!0)}),(0,n.jsx)(o.B,{open:v,src:N.imageUrl||"",alt:N.title||"",imageRef:w,onClose:()=>f(!1)})]}),(0,n.jsx)("h2",{className:"text-center text-neutral-600 text-3xl font-semibold tracking-tight whitespace-pre-wrap break-words [overflow-wrap:anywhere] hyphens-auto",children:null==N?void 0:N.title}),!!(null==N?void 0:N.subheading)&&(0,n.jsx)("p",{className:"mt-1 text-center text-sm text-neutral-600 whitespace-pre-wrap break-words [overflow-wrap:anywhere] hyphens-auto",children:null==N?void 0:N.subheading}),((null==N?void 0:N.dateRange)||(null==N?void 0:N.timeText))&&(0,n.jsxs)("div",{className:"mt-2 flex items-center justify-center gap-5 text-sm text-neutral-700",children:[(null==N?void 0:N.dateRange)&&(0,n.jsxs)("span",{className:"inline-flex items-center gap-1.5",children:[(0,n.jsx)(i.A,{sx:{fontSize:20}}),null==N?void 0:N.dateRange]}),(null==N?void 0:N.timeText)&&(0,n.jsxs)("span",{className:"inline-flex items-center gap-1.5",children:[(0,n.jsx)(s.A,{sx:{fontSize:20}}),null==N?void 0:N.timeText]})]}),!!(null==N?void 0:N.description)&&(0,n.jsx)("div",{className:"mt-4 max-h-56 overflow-y-auto",children:(0,n.jsx)("p",{className:"text-sm leading-relaxed text-neutral-800 whitespace-pre-wrap break-words [overflow-wrap:anywhere] hyphens-auto",children:null==N?void 0:N.description})}),((null==N?void 0:N.ctaLabel)||(null==N?void 0:N.ctaHref))&&(0,n.jsx)("div",{className:"mt-6 flex justify-center",children:(null==N?void 0:N.ctaHref)?(0,n.jsx)("a",{href:null==N?void 0:N.ctaHref,target:"_blank",rel:"noreferrer",className:"inline-flex items-center justify-center rounded-full bg-red-600 hover:bg-red-500 hover:shadow-2xl duration-300 px-6 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow hover:opacity-95",children:null!=(l=null==N?void 0:N.ctaLabel)?l:"Learn more"}):(0,n.jsx)("button",{className:"inline-flex items-center justify-center rounded-full bg-red-600 hover:bg-red-500 hover:shadow-2xl duration-300 px-6 py-3 text-sm font-semibold uppercase tracking-wide text-white shadow hover:opacity-95",children:null!=(c=null==N?void 0:N.ctaLabel)?c:"Learn more"})}),(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("div",{className:"items-center w-[25%] md:w-[15%]",children:h.length>1&&(0,n.jsx)("div",{className:"mt-4 w-full max-w-md mx-auto  overflow-x-scroll custom-scrollbar",children:(0,n.jsx)("div",{className:"flex items-center gap-3 px-2",children:h.map((e,t)=>{let l=t===p;return(0,n.jsx)("button",{ref:e=>{b.current[t]=e},"aria-label":"Go to slide ".concat(t+1),"aria-current":l?"true":void 0,onClick:()=>g(t),className:"\n                            h-2 md:h-3 w-2 md:w-3 rounded-full transition-all duration-300\n                            flex-shrink-0 focus:outline-none\n                            ".concat(l?"bg-neutral-900":"border-neutral-300 bg-neutral-200 hover:bg-neutral-400","\n                          ")},t)})})})})})]})]})]})}},6414:(e,t,l)=>{"use strict";l.d(t,{N:()=>n});let n=(0,l(3254).createBrowserClient)("https://enadqzzfyywsbictfwvg.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs")},6666:(e,t,l)=>{"use strict";l.d(t,{default:()=>k});var n=l(5155),a=l(2115),r=l(6217),i=l(6414),s=l(1368);async function o(e,t){var l,n;let a=(null==(l=e.name.split(".").pop())?void 0:l.toLowerCase())||"jpg",r="".concat((0,s.A)(),".").concat(a),o="events/".concat(r),{error:c}=await i.N.storage.from("events").upload(o,e,{contentType:e.type,upsert:!1});if(c)throw c;let{data:d}=i.N.storage.from("events").getPublicUrl(o);return(null==t?void 0:t.oldPath)&&await i.N.storage.from("events").remove([t.oldPath]).catch(()=>{}),{path:o,publicUrl:null!=(n=null==d?void 0:d.publicUrl)?n:null}}var c=l(7149),d=l(9267),u=l(5715),h=l(3127),m=l(4426),x=l(2114),p=l(6673),g=l(1005),v=l(7857),f=l(644),b=l(5294),w=l(7365),j=l(3649),y=l(7217);function N(e){let{status:t}=e,l={live:"Live",scheduled:"Scheduled",expired:"Expired",hidden:"Hidden"};return(0,n.jsx)("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-xs font-medium ".concat({live:"bg-green-600/15 text-green-300 ring-1 ring-green-500/30",scheduled:"bg-blue-600/15  text-blue-300  ring-1 ring-blue-500/30",expired:"bg-red-600/15   text-red-300   ring-1 ring-red-500/30",hidden:"bg-zinc-600/15  text-zinc-300  ring-1 ring-zinc-500/30"}[t]),title:l[t],"aria-label":"Status: ".concat(l[t]),children:l[t]})}var S=l(3114);function k(){var e,t,l,i,s,k,C,I,A,E;let[D,_]=(0,a.useState)(!1),[T,M]=(0,a.useState)(""),[z,O]=(0,a.useState)(""),[J,L]=(0,a.useState)(""),[U,P]=(0,a.useState)(null),[R,Y]=(0,a.useState)(null),[H,Z]=(0,a.useState)(""),[F,X]=(0,a.useState)(""),[W,B]=(0,a.useState)(""),[V,Q]=(0,a.useState)(""),[G,K]=(0,a.useState)(!1),[$,q]=(0,a.useState)(""),[ee,et]=(0,a.useState)(""),[el,en]=(0,a.useState)(!0),[ea,er]=(0,a.useState)(!0),[ei,es]=(0,a.useState)(""),[eo,ec]=(0,a.useState)(""),[ed,eu]=(0,a.useState)(null),[eh,em]=(0,a.useState)(0),[ex,ep]=(0,a.useState)([]),[eg,ev]=(0,a.useState)(!1),[ef,eb]=(0,a.useState)(""),[ew,ej]=(0,a.useState)({id:"",title:"",subheading:"",description:"",start_date:"",end_date:"",start_time:"",end_time:"",cta_label:"",cta_href:"",image_url:"",image_path:"",order:0}),[ey,eN]=(0,a.useState)(!1),[eS,ek]=(0,a.useState)(!1),[eC,eI]=(0,a.useState)(!1),[eA,eE]=(0,a.useState)({open:!1,message:"",severity:""}),[eD,e_]=(0,a.useState)(null),[eT,eM]=(0,a.useState)(0),[ez,eO]=(0,a.useState)(!1),eJ="cmsDraft_v1",eL=(0,a.useRef)(null),eU=(0,a.useRef)(null),[eP,eR]=(0,a.useState)(!1);function eY(e){P(e),Y(URL.createObjectURL(e))}function eH(){M(""),O(""),L(""),Z(""),X(""),B(""),en(!0),er(!0),es(""),ec(""),P(null),Y(null),localStorage.removeItem(eJ),eb(""),ej({id:""}),ek(!1),Q(""),K(!1),q(""),et("")}async function eZ(){try{eI(!0);let e=ex.map(e=>e.id),t=await fetch("/api/admin/events/reorder",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:e})}),l=await t.json();if(t.ok)eE(e=>({...e,open:!0,message:"Event Order Saved",severity:"success"}));else throw eE(e=>({...e,open:!0,message:"Event Reorder failed",severity:"error"})),Error((null==l?void 0:l.error)||"Reorder failed");eN(!1)}catch(e){eE(t=>({...t,open:!0,message:e instanceof Error?e.message:"Event Reorder failed",severity:"error"}))}eI(!1)}async function eF(){try{let l,n;if(""==T||null==T)return void eE(e=>({...e,open:!0,message:"Title Needed",severity:"error"}));eI(!0);let a=null,r=null,i=null==ew?void 0:ew.image_path;if(U){let e=await o(U,{oldPath:i});a=e.path,r=e.publicUrl}else if(1===eh&&ed){var e,t;a=null!=(e=null==ew?void 0:ew.image_path)?e:null,r=null!=(t=null==ew?void 0:ew.image_url)?t:null}let s={title:T,subheading:z,description:J,startDate:H||null,endDate:F||null,startTime:W||null,endTime:V||null,ctaLabel:ei,ctaHref:eo,image_path:a,image_url:r,published:G,publishAt:(0,y.dT)($)||null,unpublishAt:(0,y.dT)(ee)||null};if(ed&&0!==eh)if(l=await fetch("/api/admin/events/".concat(ed),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await l.json(),l.ok)eE(e=>({...e,open:!0,message:"Event Updated Successfully",severity:"success"}));else throw eE(e=>({...e,open:!0,message:"Event Update failed",severity:"error"})),Error((null==n?void 0:n.error)||"Update failed");else if(l=await fetch("/api/admin/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await l.json(),l.ok){let e=localStorage.getItem(eJ),t=e?JSON.parse(e):{};localStorage.setItem(eJ,JSON.stringify({...t,eventId:n.id})),0===eh&&eE(e=>({...e,open:!0,message:"Event Created Successfully",severity:"success"}))}else throw eE(e=>({...e,open:!0,message:"Event Creation failed",severity:"error"})),Error((null==n?void 0:n.error)||"Create failed");0!==eh&&(0,y.Ah)({setEvents:ep,setLoadingEvents:ev}),r&&Y(r)}catch(e){eE(t=>({...t,open:!0,message:e instanceof Error?e.message:"Save failed",severity:"error"}))}eI(!1),eH()}async function eX(e){e_(e),eE({open:!0,message:"Are you sure you want to delete this event?",severity:"warning",actionLabel:"Delete",duration:1e4,actionCallback:async()=>{try{let t=await fetch("/api/admin/events/".concat(e),{method:"DELETE"}),l=await t.json();if(t.ok)eE({open:!0,message:"Event Deleted Successfully",severity:"success"}),ep(t=>t.filter(t=>t.id!==e)),ed===e&&eu(null);else throw eE({open:!0,message:"Delete Event failed",severity:"error"}),Error((null==l?void 0:l.error)||"Delete failed")}catch(e){eE({open:!0,message:e instanceof Error?e.message:"Delete failed",severity:"error"})}finally{e_(null)}}})}(0,a.useEffect)(()=>_(!0),[]),(0,a.useEffect)(()=>eR(!0),[]),(0,a.useEffect)(()=>{try{var e,t,l,n,a;let r=localStorage.getItem(eJ);if(!r)return;let i=JSON.parse(r);M(i.title||""),O(i.subheading||""),L(i.description||""),Z(i.startDate||""),X(i.endDate||""),B(i.startTime||""),Q(i.endTime||""),en(null==(e=i.publishModal)||e),er(null==(t=i.forceOpen)||t),es(i.ctaLabel||""),ec(i.ctaHref||""),K(null==(l=i.published)||l),q(null!=(n=i.publishAt)?n:""),et(null!=(a=i.unpublishAt)?a:""),i.imageDataUrl&&Y(i.imageDataUrl)}catch(e){}},[]),(0,a.useEffect)(()=>{let e=setTimeout(async()=>{try{let e=R;!e&&U&&(e=await (0,y.zM)(U),Y(e)),localStorage.setItem(eJ,JSON.stringify({title:T,subheading:z,description:J,startDate:H,endDate:F,startTime:W,endTime:V,publishModal:el,forceOpen:ea,ctaLabel:ei,ctaHref:eo,imageDataUrl:e,published:G,publishAt:$,unpublishAt:ee}))}catch(e){}},300);return()=>clearTimeout(e)},[T,z,J,H,F,W,V,el,ea,ei,eo,U,R,G,$,ee]),(0,a.useEffect)(()=>{let e=setTimeout(()=>{var e,t,l;let n=R&&R.startsWith("data:")?R:null;if(!n)try{let e=localStorage.getItem(eJ);n=e&&null!=(l=JSON.parse(e).imageDataUrl)?l:null}catch(e){}let a={title:T,subheading:z,description:J,startDate:H,endDate:F,startTime:W,endTime:V,publishModal:el,forceOpen:ea,ctaLabel:ei,ctaHref:eo,imageDataUrl:n};null==(t=eU.current)||null==(e=t.contentWindow)||e.postMessage({type:"cms:update",payload:a},window.location.origin)},120);return()=>clearTimeout(e)},[T,z,J,H,F,W,V,el,ea,ei,eo,R]),(0,a.useEffect)(()=>{function e(e){if(!e.clipboardData)return;let t=Array.from(e.clipboardData.items).find(e=>e.type.startsWith("image/"));if(!t)return;let l=t.getAsFile();l&&eY(l)}return window.addEventListener("paste",e),()=>window.removeEventListener("paste",e)},[]),(0,a.useEffect)(()=>{0!==eh&&(0,y.Ah)({setEvents:ep,setLoadingEvents:ev})},[eh]),console.log("time",(0,y.dT)($),$+":00.000Z"),console.log("utctest",(0,y.oS)((0,y.dT)($))),console.log(ew),console.log("id",ed);let eW=ex.map(e=>{var t,l,n,a,r,i;return{id:e.id,imageUrl:null!=(t=e.image_url)?t:void 0,title:null!=(l=e.title)?l:"(untitled)",subheading:null!=(n=e.subheading)?n:"",description:null!=(a=e.description)?a:"",dateRange:(0,y.tX)(e.start_date,e.end_date),timeText:(0,y.sH)(e.start_time,e.end_time),ctaLabel:null!=(r=e.cta_label)?r:"",ctaHref:null!=(i=e.cta_href)?i:""}}),eB={id:ed||"new",imageUrl:null!=R?R:void 0,title:(null==T?void 0:T.trim())||"(untitled)",subheading:z||"",description:J||"",dateRange:(0,y.tX)(H,F),timeText:(0,y.sH)(W,V),ctaLabel:ei||"",ctaHref:eo||""},eV=(null!=(k=null==T||null==(e=T.trim())?void 0:e.length)?k:0)>0||(null!=(C=null==z||null==(t=z.trim())?void 0:t.length)?C:0)>0||(null!=(I=null==J||null==(l=J.trim())?void 0:l.length)?I:0)>0||!!H||!!F||!!W||!!V||(null!=(A=null==ei||null==(i=ei.trim())?void 0:i.length)?A:0)>0||(null!=(E=null==eo||null==(s=eo.trim())?void 0:s.length)?E:0)>0||!!R,eQ=0===eh?eV?[eB,...eW]:eW:ef?[eB]:eW,eG=H&&F&&new Date(F)<new Date(H)?"End date cannot be before start date.":"",eK=(0,y.IH)({publishModal:el,forceOpen:ea,startDate:H,endDate:F}),e$=0===eh||1===eh&&!!ef;(0,a.useEffect)(()=>{0===eh&&eH()},[eh]);let eq=(0,a.useMemo)(()=>(0,y.$h)(ex,eT,eO),[ex,eT]);return D?(0,n.jsxs)("div",{className:"font-sans flex flex-col gap-4 md:flex-row min-h-screen md:h-screen p-8 md:gap-8 sm:px-20 bg-[#151c2f]",children:[(0,n.jsxs)("div",{className:"md:w-[30%] text-white h-[90%] md:overflow-scroll custom-scrollbar shadow-xl rounded-xl bg-[#212e3f] p-3 md:p-5 space-y-4",children:[(0,n.jsx)(c.A,{sx:{borderBottom:1,borderColor:"rgba(255,255,255,0.1)"},children:(0,n.jsxs)(d.A,{value:eh,onChange:(e,t)=>{em(t),eH(),eb(""),ep([]),0===t&&eu(null)},variant:"fullWidth",sx:{"& .MuiTab-root":{color:"rgba(255,255,255,0.7)"},"& .Mui-selected":{color:"#fff"},"& .MuiTabs-indicator":{backgroundColor:"#60a5fa"}},children:[(0,n.jsx)(u.A,{label:"Create"}),(0,n.jsx)(u.A,{label:"Update"})]})}),1===eh&&(0,n.jsxs)("div",{className:"space-y-3 ".concat(eS?"hidden":""),children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"px-2 text-sm text-white/80",children:"Reorder events (drag rows)"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("button",{onClick:eZ,disabled:eC||!ey,className:"rounded-md bg-blue-500/90 hover:bg-blue-500 px-3 py-1.5 text-sm disabled:opacity-50 hover:cursor-pointer disabled:cursor-not-allowed",children:eC?(0,n.jsx)("span",{className:"inline-flex items-center px-2 gap-2",children:(0,n.jsxs)("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4A4 4 0 004 12z"})]})}):"Save"}),(0,n.jsx)(h.A,{size:"small",onClick:()=>{(0,y.Ah)({setEvents:ep,setLoadingEvents:ev}),eH()},children:(0,n.jsx)(v.A,{htmlColor:"#9ca3af",fontSize:"small"})})]})]}),(0,n.jsx)("div",{children:(0,n.jsx)(c.A,{sx:{borderBottom:1,borderColor:"rgba(255,255,255,0.1)"},children:(0,n.jsxs)(d.A,{value:eT,onChange:(e,t)=>{eM(t),console.log(t)},variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,sx:{"& .MuiTab-root":{color:"rgba(255,255,255,0.7)",fontSize:"12px",px:1.5,textTransform:"none",whiteSpace:"nowrap"},"& .Mui-selected":{color:"#67ff56"},"& .MuiTabs-indicator":{backgroundColor:"#60fa68"},"& .MuiTabs-scrollButtons.Mui-disabled":{opacity:.3}},children:[(0,n.jsx)(u.A,{label:"All"}),(0,n.jsx)(u.A,{label:"Live"}),(0,n.jsx)(u.A,{label:"Scheduled"}),(0,n.jsx)(u.A,{label:"Expired"}),(0,n.jsx)(u.A,{label:"Hidden"})]})})}),eg?(0,n.jsx)("div",{className:"flex justify-center py-4",children:(0,n.jsx)(m.A,{size:20})}):(0,n.jsx)(b.JY,{onDragEnd:function(e){if(!e.destination)return;let t=e.source.index,l=e.destination.index;t!==l&&(ep(e=>{let n=[...e],[a]=n.splice(t,1);return n.splice(l,0,a),n}),eN(!0))},children:(0,n.jsx)(b.gL,{droppableId:"events-order",isDropDisabled:ez,children:e=>(0,n.jsxs)("ul",{ref:e.innerRef,...e.droppableProps,className:"divide-y divide-white/10 rounded-lg h-[150px] md:h-[420px]  overflow-scroll custom-scrollbar",children:[eq.map((e,t)=>(0,n.jsx)(b.sx,{draggableId:e.id,index:t,isDragDisabled:ez,children:t=>{var l;return(0,n.jsxs)("li",{ref:t.innerRef,...t.draggableProps,className:"flex items-center justify-between even:bg-[#151c2f] p-2  hover:bg-white/10",children:[(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("span",{...t.dragHandleProps,className:"text-white/60 cursor-grab active:cursor-grabbing",title:"Drag to reorder",children:(0,n.jsx)(w.A,{fontSize:"small"})}),(0,n.jsx)("span",{className:"text-white hover:cursor-pointer truncate max-w-[70px] md:max-w-[150px]",onClick:()=>{let t=e.id,l=ex.find(e=>e.id===t);console.log("here ev",l),l&&(eu(l.id),M(l.title||""),O(l.subheading||""),L(l.description||""),Z(l.start_date||""),X(l.end_date||""),B(l.start_time||""),Q(l.end_time||""),es(l.cta_label||""),ec(l.cta_href||""),Y(l.image_url||null),K(!!l.published),q((0,y.oS)(l.publish_at)||""),et((0,y.oS)(l.unpublish_at)||""))},children:e.title||"(untitled)"})]}),(0,n.jsxs)("span",{className:"text-xs text-white/40",children:[(0,n.jsx)(N,{status:null!=(l=e.computed_status)?l:"hidden"}),(0,n.jsx)(h.A,{"aria-label":"delete",onClick:()=>{ek(!0),eb(e.id);let t=e.id,l=ex.find(e=>e.id===t);if(l){var n;eu(l.id),M(l.title||""),O(l.subheading||""),L(l.description||""),Z(l.start_date||""),X(l.end_date||""),B(l.start_time||""),Q(l.end_time||""),es(l.cta_label||""),ec(l.cta_href||""),Y(l.image_url||null),K(null!=(n=l.published)&&n),q((0,y.oS)(l.publish_at)||""),et((0,y.oS)(l.unpublish_at)||"")}},children:(0,n.jsx)(f.A,{className:"text-green-400 hover:text-green-500 transition duration-700 ease-in-out"})}),(0,n.jsx)(h.A,{"aria-label":"delete",onClick:()=>{eX(e.id)},children:(0,n.jsx)(g.A,{className:"text-red-400 hover:text-red-500 transition duration-700 ease-in-out"})})]})]})}},e.id)),e.placeholder,0===ex.length&&(0,n.jsx)("li",{className:"p-3 text-sm text-white/60",children:"No events yet."})]})})})]}),eS&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(h.A,{size:"small",onClick:()=>{eb(""),eH(),(0,y.Ah)({setEvents:ep,setLoadingEvents:ev})},children:(0,n.jsx)("div",{className:"border border-[rgba(255,255,255,0.1)] flex justify-center items-center p-2 rounded hover:bg-white/10 transition duration-300 ease-in-out",children:(0,n.jsx)(S.A,{htmlColor:"#9ca3af",fontSize:"small"})})}),(0,n.jsxs)(x.A,{fullWidth:!0,displayEmpty:!0,size:"small",value:ef,onChange:e=>{let t=String(e.target.value);eb(t);let l=ex.find(e=>e.id===t);l&&(ej(l),eu(l.id),M(l.title||""),O(l.subheading||""),L(l.description||""),Z(l.start_date||""),X(l.end_date||""),B(l.start_time||""),Q(l.end_time||""),es(l.cta_label||""),ec(l.cta_href||""),Y(l.image_url||null),K(!!l.published),q((0,y.oS)(l.publish_at)||""),et((0,y.oS)(l.unpublish_at)||""))},sx:{color:"#fff","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255,255,255,0.15)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(255,255,255,0.3)"}},renderValue:e=>{var t;return e?(null==(t=ex.find(t=>t.id===e))?void 0:t.title)||"---":"Select event…"},children:[eg&&(0,n.jsxs)(p.A,{disabled:!0,children:[(0,n.jsx)(m.A,{size:16,sx:{mr:1}})," Loading…"]}),!eg&&0===ex.length&&(0,n.jsx)(p.A,{disabled:!0,children:"No events yet"}),ex.map(e=>(0,n.jsx)(p.A,{value:e.id,children:e.title||"(untitled)"},e.id))]})]}),(0,n.jsx)("div",{className:"text-xs text-white/60",children:ef?"Editing: ".concat(ef):"Pick an event to edit"})]}),e$&&(0,n.jsxs)("div",{className:"md:h-[90%] overflow-scroll custom-scrollbar",children:[(0,n.jsx)(y.Hz,{imageUrl:null!=R?R:void 0,onPickClick:function(){var e;null==(e=eL.current)||e.click()},onFileSelect:function(e){var t;let l=null==(t=e.target.files)?void 0:t[0];l&&eY(l)},onDrop:function(e){var t;e.preventDefault();let l=null==(t=e.dataTransfer.files)?void 0:t[0];l&&l.type.startsWith("image/")&&eY(l)},onDragOver:function(e){e.preventDefault()},inputRef:eL}),(0,n.jsxs)("div",{className:"space-y-1 mt-2",children:[(0,n.jsx)(y.ox,{label:"Title",value:T,onChange:M,placeholder:"Enter title"}),(0,n.jsx)(y.ox,{label:"Subheading",value:z,onChange:O,placeholder:"Optional subheading"}),(0,n.jsx)(y.EY,{label:"Description",value:J,onChange:L,placeholder:"Write a short description...",rows:3}),(0,n.jsx)("div",{className:"text-xs text-white/60",children:(0,n.jsxs)("div",{className:"text-end",children:[J.length," chars"]})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,n.jsx)(y.QP,{label:"Start date",value:H,onChange:Z}),(0,n.jsx)(y.QP,{label:"End date",value:F,onChange:X,min:H||void 0})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 mt-1 gap-2",children:[(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"Start time"}),(0,n.jsx)("input",{style:{colorScheme:"dark"},type:"time",value:W,onChange:e=>B(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]}),(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"End time"}),(0,n.jsx)("input",{style:{colorScheme:"dark"},type:"time",value:V,onChange:e=>Q(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})]}),eG&&(0,n.jsx)("div",{className:"text-xs text-red-300",children:eG}),(0,n.jsxs)("div",{className:"grid grid-cols-2 mt-1 gap-2",children:[(0,n.jsx)(y.ox,{label:"CTA label",value:ei,onChange:es,placeholder:"Learn More"}),(0,n.jsx)(y.ox,{label:"CTA link",value:eo,onChange:ec,placeholder:"https://example.com"})]}),(0,n.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-3",children:[(0,n.jsxs)("label",{className:"flex items-center gap-2",children:[(0,n.jsx)("input",{type:"checkbox",checked:G,onChange:e=>K(e.target.checked)}),(0,n.jsx)("div",{className:"text-sm text-white/80",children:"Published"})]}),(0,n.jsx)("div",{}),(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"Publish at"}),(0,n.jsx)("input",{style:{colorScheme:"dark"},type:"datetime-local",value:$,onChange:e=>q(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]}),(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm mb-1 text-white/80",children:"Unpublish at"}),(0,n.jsx)("input",{style:{colorScheme:"dark"},type:"datetime-local",value:ee,min:$||void 0,onChange:e=>et(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})]}),(0,n.jsxs)("div",{className:"flex gap-2 mt-1 pt-2",children:[(0,n.jsx)("button",{onClick:eF,disabled:!eP||eC,className:"px-3 py-2 rounded-lg bg-green-400 hover:bg-green-500 hover:cursor-pointer text-black font-medium disabled:cursor-not-allowed",children:eC?(0,n.jsxs)("span",{className:"inline-flex items-center gap-2",children:[0!==eh&&ed?"Updating…":"Creating…",(0,n.jsxs)("svg",{className:"h-4 w-4 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4A4 4 0 004 12z"})]})]}):0!==eh&&ed?"Update":"Publish"}),(0,n.jsx)("button",{onClick:function(){M(""),O(""),L(""),Z(""),X(""),B(""),es(""),ec(""),P(null),Y(null),localStorage.removeItem(eJ),K(!1),q(""),et("")},className:"px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-white hover:cursor-pointer",children:"Clear"})]})]})]}),(0,n.jsxs)("div",{className:"md:w-[70%] h-[90%] md:overflow-scroll custom-scrollbar text-white shadow-xl rounded-xl bg-[#212e3f] gap-4 p-3 md:p-5",children:[(0,n.jsx)("div",{className:"mb-2 text-sm text-white/60",children:"Live preview from website"}),(0,n.jsxs)("div",{className:"relative w-full h-[720px] md:h-full border border-white/10 bg-white rounded-xl overflow-hidden",children:[(0,n.jsx)("iframe",{ref:eU,src:"/",title:"Website Live Preview",className:"absolute inset-0 object-contain h-full w-full"}),(0,n.jsx)(r.A,{container:"contained",open:eK,onClose:()=>{},events:eQ,initialIndex:Math.max(0,eQ.findIndex(e=>e.id===ed))})]}),(0,n.jsx)("div",{className:"mt-3 flex justify-between items-center border-t border-white/10 pt-3",children:(0,n.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,n.jsx)("input",{type:"checkbox",checked:el,onChange:e=>en(e.target.checked)}),(0,n.jsx)("span",{children:"Event popup modal (preview)"})]})})]}),(0,n.jsx)(j.A,{snackbarSettings:eA,setSnackbarSettings:eE})]}):null}},7217:(e,t,l)=>{"use strict";l.d(t,{$h:()=>m,Ah:()=>i,E2:()=>r,EY:()=>d,Hz:()=>a,IH:()=>x,Nb:()=>s,QP:()=>u,dT:()=>f,lP:()=>o,oS:()=>b,ox:()=>c,sH:()=>g,tX:()=>p,zM:()=>j});var n=l(5155);l(2115);let a=e=>{let{imageUrl:t,onFileSelect:l,onDrop:a,onDragOver:r,onPickClick:i,inputRef:s}=e;return(0,n.jsxs)("div",{className:"border border-dashed rounded-xl h-32 flex items-center justify-center relative hover:border-white/60 transition-colors cursor-pointer group",onClick:i,onDrop:a,onDragOver:r,title:"Click, drag & drop, or paste an image",children:[t?(0,n.jsx)("img",{src:t,alt:"Preview",className:"absolute inset-0 w-full h-full object-cover rounded-xl"}):(0,n.jsxs)("div",{className:"text-center text-white/70 px-4",children:[(0,n.jsx)("div",{className:"text-sm",children:"Image Upload"}),(0,n.jsx)("div",{className:"text-xs mt-1 opacity-80",children:"Click, drag & drop, or paste"})]}),(0,n.jsx)("div",{className:"absolute inset-0 rounded-xl ring-0 group-hover:ring-2 ring-white/10 pointer-events-none"}),(0,n.jsx)("input",{ref:s,type:"file",accept:"image/*",onChange:l,className:"hidden"})]})};async function r(e){let{setEvents:t,setLoadingEvents:l}=e;l(!0);try{var n,a;let e=await fetch("/api/events",{cache:"no-store"}),l=await e.json();if(console.log(l,"fetched data for homepage"),console.log("ANON key fingerprint:",(n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs",void 0===n)?void 0:n.slice(0,6),"…",(a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVuYWRxenpmeXl3c2JpY3Rmd3ZnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxODQ1OTIsImV4cCI6MjA3MTc2MDU5Mn0.VPk2P-BIeJs01QDgUwYtn-K66onMC70WpZeYdHZbEXs",void 0===a)?void 0:a.slice(-6)),!e.ok)throw Error((null==l?void 0:l.error)||"Failed to load events");let r=(l.items||[]).sort((e,t)=>{var l,n;return(null!=(l=e.order)?l:0)-(null!=(n=t.order)?n:0)});t(r)}catch(e){console.error(e)}finally{l(!1)}}async function i(e){let{setEvents:t,setLoadingEvents:l}=e;l(!0);try{let e=await fetch("/api/admin/events",{cache:"no-store"}),l=await e.json();if(!e.ok)throw Error((null==l?void 0:l.error)||"Failed to load events");let n=(l.items||[]).sort((e,t)=>{var l,n;return(null!=(l=e.order)?l:0)-(null!=(n=t.order)?n:0)});t(n)}catch(e){console.error(e)}finally{l(!1)}}async function s(e){let{setSeasons:t,setLoading:l}=e;try{null==l||l(!0);let e=await fetch("/api/seasons",{cache:"no-store"}),n=await e.json();if(!e.ok)throw Error((null==n?void 0:n.error)||"Failed to load seasons");let a=Array.isArray(null==n?void 0:n.items)?n.items:[];return t(a),a}catch(e){return console.error(e),t([]),[]}finally{null==l||l(!1)}}async function o(e){let{setHotspots:t,setLoading:l}=e;try{null==l||l(!0);let e=await fetch("/api/hotspots",{cache:"no-store"}),n=await e.json();if(!e.ok)throw Error((null==n?void 0:n.error)||"Failed to load seasons");let a=Array.isArray(null==n?void 0:n.items)?n.items:[];return t(a),a}catch(e){return console.error(e),t([]),[]}finally{null==l||l(!1)}}function c(e){let{label:t,value:l,onChange:a,placeholder:r}=e;return(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,n.jsx)("input",{value:l,onChange:e=>a(e.target.value),placeholder:r,className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})}function d(e){let{label:t,value:l,onChange:a,placeholder:r,rows:i=5}=e;return(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,n.jsx)("textarea",{value:l,maxLength:500,onChange:e=>a(e.target.value),placeholder:r,rows:i,className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30 resize-y"})]})}function u(e){let{label:t,value:l,onChange:a,min:r,max:i}=e;return(0,n.jsxs)("label",{className:"block",children:[(0,n.jsx)("div",{className:"text-sm mb-1 text-white/80",children:t}),(0,n.jsx)("input",{style:{colorScheme:"dark"},type:"date",value:l,min:r,max:i,onChange:e=>a(e.target.value),className:"w-full rounded-lg bg-[#131a2a] border border-white/10 px-3 py-2 outline-none focus:border-white/30"})]})}let h=["all","live","scheduled","expired","hidden"],m=(e,t,l)=>{if(0===t)return l(!1),null!=e?e:[];{var n;console.log({tabIdx:t}),l(!0);let a=null!=(n=h[t])?n:"live";return console.log({wanted:a}),(null!=e?e:[]).filter(e=>(e=>{if(null==e?void 0:e.computed_status)return e.computed_status;if(!(null==e?void 0:e.published))return"hidden";let t=Date.now(),l=(null==e?void 0:e.publish_at)?new Date(e.publish_at).getTime():null,n=(null==e?void 0:e.unpublish_at)?new Date(e.unpublish_at).getTime():null;return l&&l>t?"scheduled":n&&n<=t?"expired":"live"})(e)===a)}};function x(e){let{publishModal:t,forceOpen:l,startDate:n,endDate:a}=e;if(!t)return!1;if(l)return!0;let r=new Date,i=n?function(e){let t=new Date(e);return t.setHours(0,0,0,0),t}(new Date(n)):new Date(0),s=a?function(e){let t=new Date(e);return t.setHours(23,59,59,999),t}(new Date(a)):new Date(864e13);return r>=i&&r<=s}function p(e,t){if(!e&&!t)return"";if(e&&!t)return w(e);if(!e&&t)return w(t);let l=new Date(e),n=new Date(t);if(isNaN(l.getTime())||isNaN(n.getTime()))return"";if(l.getFullYear()===n.getFullYear()&&l.getMonth()===n.getMonth()){let e=l.toLocaleString(void 0,{month:"short"});return"".concat(e," ").concat(l.getDate(),"–").concat(n.getDate(),", ").concat(l.getFullYear())}return"".concat(w(e)," – ").concat(w(t))}function g(e,t){let l=v(e),n=v(t);return l||n?l&&!n?l:!l&&n?n:"".concat(l," – ").concat(n):""}function v(e,t){var l;let n=function(e){var t,l;if(!(null==e?void 0:e.trim()))return null;let n=/^(\d{1,2})(?::(\d{1,2}))?(?::(\d{1,2})(?:\.\d+)?)?$/.exec(e.trim());if(!n)return null;let a=Number(n[1]),r=Number(null!=(t=n[2])?t:"0"),i=Number(null!=(l=n[3])?l:"0");return Number.isNaN(a)||Number.isNaN(r)||Number.isNaN(i)||a<0||a>23||r<0||r>59||i<0||i>59?null:{h:a,m:r}}(e);if(!n)return"";let a=n.h%12;0===a&&(a=12);let r=n.h<12?"am":"pm",i=(null==t?void 0:t.upper)?r.toUpperCase():r;return"".concat(a,":").concat((l=n.m)<10?"0".concat(l):String(l)," ").concat(i)}function f(e){return e?new Date(e).toISOString():null}let b=e=>{if(!e)return"";let t=new Date(e),l=e=>String(e).padStart(2,"0");return"".concat(t.getFullYear(),"-").concat(l(t.getMonth()+1),"-").concat(l(t.getDate()),"T").concat(l(t.getHours()),":").concat(l(t.getMinutes()))};function w(e){let t=new Date(e);return isNaN(t.getTime())?"":t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function j(e){return new Promise((t,l)=>{let n=new FileReader;n.onload=()=>t(String(n.result)),n.onerror=l,n.readAsDataURL(e)})}}},e=>{e.O(0,[1309,3254,6766,8019,4834,4033,8406,8054,8441,5964,7358],()=>e(e.s=1247)),_N_E=e.O()}]);