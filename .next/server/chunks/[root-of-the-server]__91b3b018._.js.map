{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Mata/Documents/GitHub/grand_hyatt/lib/supabase/server.ts"],"sourcesContent":["\r\nimport { cookies } from 'next/headers';\r\nimport { createServerClient, type CookieOptions } from '@supabase/ssr';\r\n\r\nexport async function createSupabaseServer() {\r\n  const cookieStore = await cookies();\r\n\r\n  return createServerClient(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        get(name: string) {\r\n          return cookieStore.get(name)?.value;\r\n        },\r\n        set(name: string, value: string, options: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value, ...options });\r\n          } catch {\r\n            // no-op in RSC (only works in route handlers/actions)\r\n          }\r\n        },\r\n        remove(name: string, options: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value: '', ...options });\r\n          } catch {\r\n            // no-op in RSC\r\n          }\r\n        },\r\n      },\r\n    }\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;AACA;AACA;AAAA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IAEhC,OAAO,CAAA,GAAA,2KAAA,CAAA,qBAAkB,AAAD,sUAGtB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAsB;gBACrD,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAM;gBACN,sDAAsD;gBACxD;YACF;YACA,QAAO,IAAY,EAAE,OAAsB;gBACzC,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;oBAAC;gBAChD,EAAE,OAAM;gBACN,eAAe;gBACjB;YACF;QACF;IACF;AAEJ","debugId":null}},
    {"offset": {"line": 150, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Mata/Documents/GitHub/grand_hyatt/src/app/api/admin/events/%5Bid%5D/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { createSupabaseServer } from '../../../../../../lib/supabase/server';\r\n\r\nexport const runtime = 'nodejs';\r\ntype Ctx = { params: Promise<{ id: string }> };\r\n\r\nexport async function GET(_req: Request, {params}: Ctx) {\r\n  const { id } = await params;\r\n  const supabase = await createSupabaseServer();\r\n  const { data, error } = await supabase\r\n    .from('events_with_status')\r\n    .select('*')\r\n    .eq('id', id)\r\n    .single();\r\n  if (error) return NextResponse.json({ error: error.message }, { status: 404 });\r\n  return NextResponse.json({ item: data });\r\n}\r\n\r\nexport async function PATCH(req: Request, {params}: Ctx) {\r\n  const { id } = await params;\r\n  const supabase = await createSupabaseServer();\r\n  const body = await req.json();\r\n\r\n  const { data: { user } } = await supabase.auth.getUser();\r\n  if (!user) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });\r\n\r\n  const update = {\r\n    title: body.title ?? undefined,\r\n    subheading: body.subheading ?? undefined,\r\n    description: body.description ?? undefined,\r\n    start_date: body.startDate ?? undefined,\r\n    end_date: body.endDate ?? undefined,\r\n    start_time: body.startTime ?? undefined,\r\n    end_time: body.endTime ?? undefined,\r\n    cta_label: body.ctaLabel ?? undefined,\r\n    cta_href: body.ctaHref ?? undefined,\r\n    image_url: body.image_url ?? undefined,\r\n    published: typeof body.published === 'boolean' ? body.published : undefined,\r\n    publish_at: ensureUtcIso(body.publishAt) === undefined ? undefined : ensureUtcIso(body.publishAt),\r\n    unpublish_at: ensureUtcIso(body.unpublishAt) === undefined ? undefined : ensureUtcIso(body.unpublishAt),\r\n    order: typeof body.order === 'number' ? body.order : undefined,\r\n  } as const;\r\n\r\n  const { data, error } = await supabase\r\n    .from('events')\r\n    .update(update)\r\n    .eq('id', id)\r\n    .select()\r\n    .single();\r\n\r\n  if (error) return NextResponse.json({ error: error.message }, { status: 500 });\r\n  return NextResponse.json({ item: data });\r\n}\r\n\r\n\r\nexport async function DELETE(\r\n  _req: Request,\r\n  {params}: Ctx\r\n) {\r\n  const { id } = await params;\r\n  const supabase = await createSupabaseServer();\r\n\r\n  const { data: ev, error: readErr } = await supabase\r\n    .from('events')\r\n    .select('image_url')\r\n    .eq('id', id)\r\n    .single();\r\n\r\n  if (readErr) return NextResponse.json({ error: readErr.message }, { status: 404 });\r\n\r\n  const { error } = await supabase.from('events').delete().eq('id', id);\r\n  if (error) return NextResponse.json({ error: error.message }, { status: 500 });\r\n\r\n  const path = toStoragePath(\r\n    ev?.image_url,\r\n    'events'\r\n  );\r\n  if (path) {\r\n    try {\r\n      await supabase.storage.from('events').remove([path]);\r\n    } catch {\r\n      // ignore; keep delete successful even if storage remove fails\r\n    }\r\n  }\r\n\r\n  return NextResponse.json({ ok: true });\r\n}\r\n\r\nexport function toStoragePath(\r\n  urlOrPath?: string | null,\r\n  bucket = 'events'\r\n): string | null {\r\n  if (!urlOrPath) return null;\r\n\r\n  if (!/^https?:\\/\\//i.test(urlOrPath)) {\r\n    const noBucket = urlOrPath.replace(new RegExp(`^${bucket}/`), '');\r\n    return noBucket || null;\r\n  }\r\n\r\n  try {\r\n    const u = new URL(urlOrPath);\r\n    const m = u.pathname.match(\r\n      new RegExp(`/object/(?:public|sign)/${bucket}/(.+)$`)\r\n    );\r\n    if (m && m[1]) return m[1];\r\n  } catch {\r\n    // ignore parsing errors\r\n  }\r\n  return null;\r\n}\r\n\r\nexport function ensureUtcIso(v?: string | null) {\r\n  if (!v) return null;\r\n  // If it already has Z or an offset, trust it; else treat as local\r\n  if (/[zZ]$/.test(v) || /[+\\-]\\d\\d:\\d\\d$/.test(v)) return v;\r\n  return new Date(v).toISOString();\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}